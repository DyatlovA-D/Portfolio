#!/usr/bin/env python
# coding: utf-8

# <div style="background:#e5e5e5; color:#000; padding:10px">
# 
# –ü—Ä–∏–≤–µ—Ç –µ—â–µ —Ä–∞–∑!\
# –ü—Ä–æ–µ–∫—Ç –∏ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–∏–Ω—è—Ç—ã, —Ç—ã –º–æ–ª–æ–¥–µ—Ü!
#     
# –†–µ–∫–æ–º–µ–Ω–¥—É—é –ø–æ—á–∏—Ç–∞—Ç—å —Å—Ç–∞—Ç—å—é –ø–æ –≤—ã–±–æ—Ä—É –º–µ—Ç–æ–¥–∞ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏,  –¥–∞–∂–µ –ø–æ –Ω–∞—à–∏–º –¥–∞–Ω–Ω—ã–º –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã: https://vaael.ru/ru/article/view?id=1596
# 
# –ñ–¥—É –ø—Ä–æ–µ–∫—Ç –ø–æ SQL.
# 
# </div>

# <div style="background:#e5e5e5; color:#000; padding:10px">
# 
# –ü—Ä–∏–≤–µ—Ç!\
# –ü—Ä–æ–µ–∫—Ç –ø—Ä–∏–Ω–∏–º–∞—é –≤ —Ç–∞–∫–æ–º –≤–∏–¥–µ, –Ω–æ –ø–æ—á–∏—Ç–∞–π, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ –ø–æ–≤–æ–¥—É –æ–±—Ä–µ–∑–∫–∏ –≤—ã–±—Ä–æ—Å–æ–≤ –∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏.
# 
# –ñ–¥—É —Å—Å—ã–ª–∫—É –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—É—é –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é.
# </div>

# <div style="border:solid black 2px; padding: 20px">
# –ê–Ω–Ω–∞, –ø—Ä–∏–≤–µ—Ç!
#     
# –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é —Å—Ç–æ–∏—Ç –¥–µ–ª–∞—Ç—å –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –±–ª–∏–∑–æ–∫ –∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é, —á—Ç–æ–±—ã –Ω–µ –¥–µ–ª–∞—Ç—å –¥–≤–æ–π–Ω—É—é —Ä–∞–±–æ—Ç—É, —Ç.–∫. –≤ –ø—Ä–æ–µ–∫—Ç–µ —è–≤–Ω–æ –±—É–¥—É—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.
#     
# –°–≤–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —è –±—É–¥—É –≤—ã–¥–µ–ª—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
# <div class="alert alert-danger">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
#     
#   ‚ùå –¢–∞–∫ –≤—ã–¥–µ–ª–µ–Ω–æ —Ç–æ, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å, –ø—Ä–µ–∂–¥–µ —á–µ–º —è —Å–º–æ–≥—É –ø—Ä–∏–Ω—è—Ç—å —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç.
# </div>
#     
#     
# <div class="alert alert-warning">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
#     
#   ‚ö†Ô∏è –¢–∞–∫ –æ—Ç–º–µ—á–µ–Ω—ã –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫ –¥–æ—Ä–∞–±–æ—Ç–∫–µ –º–æ–º–µ–Ω—Ç—ã. M–æ–∂–µ—à—å —É—á–µ—Å—Ç—å –∏—Ö –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞. –ù–∞ —Ç–≤–æ–µ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ.
# </div>
#     
#     
# <div class="alert alert-success">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
#     
#   ‚úîÔ∏è –ê —Ç–∞–∫ —É–¥–∞—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏ –ø–æ–¥—Ö–æ–¥—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–æ–∏—Ç –æ–ø–∏—Ä–∞—Ç—å—Å—è –≤ –±—É–¥—É—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.
# </div>
#     
#     
# <div style="border:solid black 2px; padding: 20px">
#   
#     
#   <b>–ß–µ–∫-–ª–∏—Å—Ç –¥–æ—Ä–∞–±–æ—Ç–æ–∫</b>
#     
#   üìÉ –¢–∞–∫–æ–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –±—É–¥–µ—Ç –≤ –∫–æ–Ω—Ü–µ —Ç–µ—Ç—Ä–∞–¥–∫–∏. –í –Ω–µ–º –±—É–¥—É—Ç –µ—â–µ —Ä–∞–∑ —É–∫–∞–∑–∞–Ω—ã –Ω—é–∞–Ω—Å—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.
# </div>
# 
# –ü—Ä–µ–¥–ª–∞–≥–∞—é —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –≤ —Ñ–æ—Ä–º–µ –¥–∏–∞–ª–æ–≥–∞: –µ—Å–ª–∏ —Ç—ã <b>—á—Ç–æ-—Ç–æ –º–µ–Ω—è–µ—à—å</b> –≤ —Ä–∞–±–æ—Ç–µ –ø–æ –º–æ–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º ‚Äî <b>–Ω–∞–ø–∏—à–∏ –æ–± —ç—Ç–æ–º</b> –≤ —è—á–µ–π–∫–µ `Markdown` –∏ –ø–æ–º–µ—á–∞–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫–∞–∫–∏–º-—Ç–æ –∑–∞–º–µ—Ç–Ω—ã–º —Ü–≤–µ—Ç–æ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä —Ç–∞–∫:
#     
#     
# ```
# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
#     
#   –¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è.
# </div>
# ```
#     
# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
#     
#   –¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è.
# </div>
#     
# –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, <b>–Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–π, –Ω–µ –∏–∑–º–µ–Ω—è–π –∏ –Ω–µ —É–¥–∞–ª—è–π –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</b>. –¢–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç —Ä–∞–±–æ—Ç—ã –ø–æ–º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ–µ.
# 
# </div>

# # –í—ã–ø—É—Å–∫–Ω–æ–π –ø—Ä–æ–µ–∫—Ç –Ø–Ω–¥–µ–∫—Å –ü—Ä–∞–∫—Ç–∏–∫—É–º (e-com). –í—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –∫–æ–º–ø–∞–Ω–∏–∏ "–ü–æ–∫–∞ –≤—Å–µ –µ—â–µ —Ç—É—Ç"

# **–û–ø–∏—Å–∞–Ω–∏–µ**: –î–ª—è –∫–æ–º–ø–∞–Ω–∏–∏ "–ü–æ–∫–∞ –≤—Å–µ –µ—â–µ —Ç—É—Ç" (–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –¥–æ–º–∞) –Ω—É–∂–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Ä–∞–∑–±–∏–≤–∫—É –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç—ã, —á—Ç–æ–±—ã –¥–∞–ª–µ–µ –ø–æ –Ω–∏–º –∫–æ–º–ø–∞–Ω–∏—è –º–æ–≥–ª–∞ –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å —Ä–µ–∫–ª–∞–º–Ω—ã–µ —Ä–∞—Å—Å—ã–ª–∫–∏
# 
# **–¶–µ–ª—å**: –°–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
# 
# **–î–∞–Ω–Ω—ã–µ**:
#    - date ‚Äî –¥–∞—Ç–∞ –∑–∞–∫–∞–∑–∞
#    - customer_id ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–∫—É–ø–∞—Ç–µ–ª—è
#    - order_id ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–∫–∞–∑–∞
#    - product ‚Äî –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
#    - quantity ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–∞ –≤ –∑–∞–∫–∞–∑–µ
#    - price ‚Äî —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞

# **–≠—Ç–∞–ø—ã**: 
# 
# 1. –í–≤–æ–¥–Ω–æ–µ –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏–µ —Å –¥–∞–Ω–Ω—ã–º–∏, –∞ –∏–º–µ–Ω–Ω–æ:
#     - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤
#     - –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö 
#     - –ù–∞–ª–∏—á–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ 
#     - –ù–∞–ª–∏—á–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
# 2. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –∞ –∏–º–µ–Ω–Ω–æ:
#     - —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —è–≤–Ω—ã—Ö –∏ –Ω–µ—è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ 
#     - –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π\—É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏
#     - —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π
#     - –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ç–∏–ø–∞–º
#     - —Ä–∞–∑–±–∏–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ 5 –∫–∞—Ç–µ–≥–æ—Ä–∏–π
# 3. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö:
#     - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã: –ª–∏–Ω–µ–π–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∏ –æ–±—â—É—é –≤—ã—Ä—É—á–∫—É –ø–æ –º–µ—Å—è—Ü–∞–º –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ–∫—É–ø–æ–∫
#     - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–∫—É–ø–æ–∫ –∏ —Å—É–º–º –ø–æ –∑–∞–∫–∞–∑–∞–º: –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∞—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤ –∏ —Å—É–º–º –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∏–≤—ã—á–µ–∫
#     - –∞–Ω–∞–ª–∏–∑ –ø–æ —Ü–µ–Ω–æ–≤—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º: –±–æ–∫—Å–ø–ª–æ—Ç –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ —Ü–µ–Ω, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∫–ª–∏–µ–Ω—Ç—ã –ø–æ–∫—É–ø–∞—é—Ç —á–∞—â–µ –≤—Å–µ–≥–æ.
#     - –∞–Ω–∞–ª–∏–∑ –ø–∏–∫–æ–≤—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ –ø–æ–∫—É–ø–æ–∫: —Ö–∏—Ç–º—ç–ø, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏ –∏ —á–∞—Å–∞–º –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø–∏–∫–æ–≤—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤
#     - –º–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
# 4. –ö–ª–∞—Å—Ç–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑: 
#     - —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π (—Å—Ä–µ–¥–Ω–∏–π —á–µ–∫, —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ, —Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∞–π—Å –∏ —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –∑–∞–∫–∞–∑–µ) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞ K-means –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π
#     - —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç–æ–≤–∞—Ä–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π: –∫–∞–∫–∏–µ —Ç–æ–≤–∞—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã —Å—Ä–µ–¥–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
#     - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∂ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞
#     - –≤—ã—è–≤–ª–µ–Ω–∏–µ —Å–µ–∑–æ–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –ø–æ —Ç–æ–≤–∞—Ä–Ω—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º, —á—Ç–æ–±—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –≥–æ–¥–∞ –∏–ª–∏ –ø–µ—Ä–∏–æ–¥–æ–≤ –∞–∫—Ü–∏–π
# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≥–∏–ø–æ—Ç–µ–∑:
#     - –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —Ç—Ä–µ—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≥–∏–ø–æ—Ç–µ–∑ –æ–± –æ—Ç–ª–∏—á–∏–∏ –º–µ–∂–¥—É —Å—Ä–µ–¥–Ω–∏–º —á–µ–∫–æ–º, —Å—Ä–µ–¥–Ω–∏–º –ø—Ä–∞–π—Å–æ–º –∏ —Å—Ä–µ–¥–Ω–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–∏–π –º–µ–∂–¥—É –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏
#     - –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–æ–∫
# 6. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:
#     - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∞–º—ã—Ö –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤: –≤—ã—è–≤–∏—Ç—å –≥—Ä—É–ø–ø—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –∏ –º–Ω–æ–≥–æ –ø–æ–∫—É–ø–∞—é—Ç, –∏ —Ç–µ, –Ω–∞ –∫–æ–≥–æ –Ω–µ —Å—Ç–æ–∏—Ç —Ç—Ä–∞—Ç–∏—Ç—å —Ä–µ–∫–ª–∞–º–Ω—ã–π –±—é–¥–∂–µ—Ç
#     - –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ü–µ–ª–µ–≤—ã—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–µ–≥–º–µ–Ω—Ç–∞
#     - –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏: –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Å –Ω–∏–∑–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –∏–ª–∏ –∞–∫—Ü–∏–π —Å —Ü–µ–ª—å—é –ø–æ–≤—ã—à–µ–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.
# 7. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏

# In[1]:


# –∏–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫
import pandas as pd
from scipy.stats import levene
import datetime as dt
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from scipy import stats
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler
import scipy.cluster.hierarchy as sch


# ### –ò–∑—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

# In[2]:


# –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –∏–∑—É—á–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

df = pd.read_csv('/datasets/ecom_dataset_upd.csv')
df.info()


# In[3]:


df.head()


# In[4]:


# –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –∑–Ω–∞—á–µ–Ω–∏—è—Ö
df.isna().sum()


# In[5]:


# –ø–æ—Å–º–æ—Ç—Ä–∏–º –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–µ–µ –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∞–π—Å–∞ 
df['price'].describe()


# In[6]:


# –ø–æ—Å–º–æ—Ç—Ä–∏–º –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–µ–µ –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–ª-–≤–∞ —Ç–æ–≤–∞—Ä–∞
df['quantity'].describe()


# In[7]:


df.columns


# In[8]:


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
print(f'–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤: {df.duplicated().sum()}')


# In[9]:


# –ò–∑—É—á–∏–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ—è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã
for i in sorted(df['product'].unique()):
    print(i)


# In[10]:


# –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ. —Å–æ–∑–¥–∞–¥–∏–º —Å—Ç–æ–ª–±–µ—Ü-–∫–æ–ø–∏—é –∏ –ø—Ä–µ–¥–æ–±—Ä–±–æ—Ç–∞–µ–º –µ–µ
df['products_dupl_check'] = df['product']

# –ü—Ä–∏–≤–æ–¥–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É: —É–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã, –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è, –¥–µ–ª–∞–µ–º —Å—Ç—Ä–æ—á–Ω—ã–º–∏, –∑–∞–º–µ–Ω—è–µ–º "—ë" –Ω–∞ "–µ"
df['products_dupl_check'] = df['products_dupl_check'].str.replace('—ë', '–µ', regex=False)
df['products_dupl_check'] = df['products_dupl_check'].str.replace(r'[\s+]', '', regex=True) # —É–±—Ä–∞–ª–∏ –ø—Ä–æ–±–µ–ª—ã
df['products_dupl_check'] = df['products_dupl_check'].str.replace(r'[^\w\s]', '', regex=True).str.lower() #—É–±—Ä–∞–ª–∏ –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è, –ø—Ä–∏–≤–µ–ª–∏ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É

# –ù–∞—Ö–æ–¥–∏–º –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ –Ω–æ–≤–æ–º —Å—Ç–æ–ª–±—Ü–µ –∏ –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–∞–∫–∏–µ —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –∏—Å—Ö–æ–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç–ª–∏—á–∞—é—Ç—Å—è
duplicates = df[df.duplicated(['products_dupl_check'], keep=False) & ~df['product'].duplicated(keep=False)]


# In[11]:


duplicates_lst = duplicates['products_dupl_check'].to_list()


# In[12]:


for i in df[df['products_dupl_check'].isin(duplicates_lst)]['product'].sort_values():
    print(i)


# **–í—ã–≤–æ–¥:**
# 
# 1. –í—Å–µ–≥–æ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ 5 —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ 7474 —Å—Ç—Ä–æ–∫
# 2. –ü—Ä–æ–ø—É—Å–∫–æ–≤ –∏ —è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç
# 3. –ù–µ—è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã. –î–ª—è —ç—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–ª–±—Ü–µ —Å –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–º —Ç–æ–≤–∞—Ä–∞ –±—ã–ª–∏ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É: –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã –ø—Ä–æ–±–µ–ª—ã, –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è, –≤—Å–µ –±—É–∫–≤—ã –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –≤ —Å—Ç—Ä–æ—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç, –∞ –±—É–∫–≤–∞ "—ë" –∑–∞–º–µ–Ω–µ–Ω–∞ –Ω–∞ "–µ". –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –Ω–æ–≤–æ–º —Å—Ç–æ–ª–±—Ü–µ products_dupl_check, –∫–æ—Ç–æ—Ä—ã–π –Ω–æ—Å–∏—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ - —Å –ø–æ–º–æ—â—å—é –Ω–µ–≥–æ –Ω–∞ —ç—Ç–∞–ø–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ—è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –±—É–¥—É—Ç —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
# 4. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–æ–ª–±—Ü—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö - –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —á—Ç–µ–Ω–∏—è –º–æ–∂–Ω–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –≤ –≤–∏–¥ "—Å –∑–∞–≥–ª–∞–≤–Ω–æ–π –±—É–∫–≤—ã", –∞ –¥–∞—Ç—É –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ —Ñ–æ—Ä–º–∞—Ç datetime
# 5. –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ describe —É–∫–∞–∑–∞–ª, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ - –Ω—É–∂–Ω–æ –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ –ø–æ–≥—Ä—É–∂–∞—Ç—å—Å—è –≤ –¥–µ—Ç–∞–ª–∏ —ç—Ç–∏—Ö –∞–Ω–æ–º–∞–ª–∏–π –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏—Ö

# ### –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

# In[13]:


# –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –¥–∞—Ç—ã –≤ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ñ–æ—Ä–º–∞—Ç
df['date'] = pd.to_datetime(df['date'], format='%Y%m%d%H')


# In[14]:


# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ capitalize –∫ –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –≤ —Å—Ç–æ–ª–±—Ü–µ 'product'
df['product'] = df['product'].apply(lambda x: x.capitalize() if isinstance(x, str) else x)


# In[15]:


# —É–¥–∞–ª–∏–º –¥—É–±–ª–∏, –≤—ã–∑–≤–∞–Ω–Ω—ã–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–º —Ç–æ–≤–∞—Ä–∞. –£—á—Ç–µ–º, —á—Ç–æ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –º–æ–≥—É—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è –æ—Ç –∑–∞–∫–∞–∑–∞ –∫ –∑–∞–∫–∞–∑—É
df = df.drop_duplicates(subset=['order_id', 'products_dupl_check'])
df.info()


# In[16]:


# –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ –∞–±—Å–æ–ª—é—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º id –∑–∞–∫–∞–∑–æ–≤. –ù–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ —Ç–∞–∫–∏–µ –∞–Ω–æ–º–∞–ª–∏–∏ –±—ã–ª–∏ –¥–æ–ø—É—â–µ–Ω—ã 
df['order_id'] = df['order_id'].abs()


# In[17]:


# –∏–∑—É—á–∏–º –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–µ–µ –∞–Ω–æ–º–∞–ª–∏–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É
df.groupby(by=['order_id', 'product'])['quantity'].sum().sort_values(ascending=False).head()


# In[18]:


# —É–¥–∞–ª–∏–º –∑–∞–∫–∞–∑ —Å –∞–Ω–æ–º–∞–ª–∏–µ–π
df = df[df['order_id'] != 71743]
df.info()


# In[19]:


# –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∞–Ω–æ–º–∞–ª–∏–∏ –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ (–ø–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞)
df[['product', 'quantity']].drop_duplicates().sort_values(by='quantity', ascending=False).head(60)


# In[20]:


# –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∞–Ω–æ–º–∞–ª–∏–∏ –≤ –ø—Ä–∞–π—Å–µ (–ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é)
df[['product', 'price']].drop_duplicates().sort_values(by='price', ascending=True).head(60)


# In[21]:


# –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∞–Ω–æ–º–∞–ª–∏–∏ –≤ –ø—Ä–∞–π—Å–µ (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)
df[['product', 'price']].drop_duplicates().sort_values(by='price', ascending=False).head(60)


# In[22]:


# –∏–∑—É—á–∏–º –≤—Å–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
df = df.sort_values(by='product')
for i in df['product']:
    print(i)


# In[23]:


# –ø–æ—Å–ª–µ –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è —Å –¥–∞–Ω–Ω—ã–º–∏ —Å–æ–∑–¥–∞–¥–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

def categorize_product(product_name):
    product_name = product_name.lower().strip()  # –ü—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –∏ —É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
    if any(keyword in product_name for keyword in (
        '–∫—Ä—É–∂–∫–∞', '–∫—Ä—É–∂–µ–∫', '–±–ª—é–¥–æ', '–±–∏–¥–æ–Ω', '–≤–∏–ª–∫–∞', '–ª–æ–∂–∫–∞', '–∫–∞—Ä—Ç–æ—Ñ–µ–ª–µ–º—è–ª–∫–∞',
        '–∫–∞—Å—Ç—Ä—é–ª—è', '–∫—É–≤—à–∏–Ω', '–ª–æ–ø–∞—Ç–∫–∞', '–ª–æ—Ç–æ–∫', '–º–∏—Å–∫–∞', '–±–æ–∫–∞–ª', '–Ω–æ–∂',
        '—Å—Ç–∞–∫–∞–Ω', '—Å—Ç–æ–ª–æ–≤—ã—Ö', '–∫–µ–∫—Å–æ–≤', '—Ñ—É–∂–µ—Ä', '—Å–∞–ª–∞—Ç–Ω–∏–∫', '–Ω–æ–∂–µ—Ç–æ—á–∫–∞',
        '–æ—Ä–µ—Ö–æ–∫–æ–ª–∫–∞', '–≤–∏—à–µ–Ω', '–ø—Ä–æ—Å–µ–∏–≤–∞—Ç–µ–ª—å', '–ø—Ä–æ—Ç–∏–≤–µ–Ω—å', '—Ä–∞–∑–¥–µ–ª–æ—á–Ω–∞—è',
        '–º–∏–∫—Å–µ—Ä', '–æ–≤–æ—â–µ–≤–∞—Ä–∫–∞', '–æ–≤–æ—â–µ—á–∏—Å—Ç–∫–∞', '—Ä–∞—Å—Å–µ–∫–∞—Ç–µ–ª—å', '—Ä—ã–±–æ—á–∏—Å—Ç–∫–∞',
        '—Å–∞—Ö–∞—Ä–Ω–∏—Ü–∞', '—Å–∏—Ç–æ', '—Å–∫–∞–ª–∫–∞', '—Å–∫–æ–≤–æ—Ä–æ–¥–∞', '—Å–∫—Ä–µ–±–æ–∫',
        '—Å–æ–∫–æ–≤–∞—Ä–∫–∞', '—Å–æ–∫–æ–≤—ã–∂–∏–º–∞–ª–∫–∞', '—Å—Ç–µ–∫–ª—è–Ω–Ω–∞—è –∫—Ä—ã—à–∫–∞', '—Ç–∞—Ä–µ–ª–∫–∞', '—Ç–µ—Ä–∫–∞',
        '—Ç–µ—Ä–º–æ—Å', '—Ç–æ–ª–∫—É—à–∫–∞', '—Ç–æ—Ä—Ç–Ω–∏—Ü–∞', '—Ö–ª–µ–±–Ω–∏—Ü–∞', '—á–∞–π–Ω–∏–∫',
        '–∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∏–π', '—ç–ª–µ–∫—Ç—Ä–æ—à–æ–ø–æ—Ä', '–±–ª—é–¥—Ü–µ', '–±—É–ª—å–æ–Ω', '–≤–µ–Ω—á–∏–∫', '–ø–∞—Ä–æ–≤–∞—Ä–∫–∞', '–º–∞—Å–ª–µ–Ω–∫–∞',
        '–∫–∏–ø—è—Ç–∏–ª—å–Ω–∏–∫', '–∫–æ—Ç—ë–ª', '–∫–æ—Ç–µ–ª', '–º–∞–Ω—Ç–æ–≤–∞—Ä–∫–∞', '–ø–æ–ª–æ–≤–Ω–∏–∫', '—á–µ—Å–Ω–æ–∫–∞', '—Å–∞–ª—Ñ–µ—Ç–Ω–∏—Ü–∞', '—Å–æ—Ç–µ–π–Ω–∏–∫',
        '—ç–ª–µ–∫—Ç—Ä–æ—à—Ç–æ–ø–æ—Ä')):
        return '–ü–æ—Å—É–¥–∞'
    
    elif any(keyword in product_name for keyword in (
        '—ë—Ä—à', '–µ—Ä—à', '—â–µ—Ç–∫–∞', '–∞–Ω—Ç–∏–∂–∏—Ä', '–∞–Ω—Ç–∏–Ω–∞–∫–∏–ø–∏–Ω', '–±–∞–Ω–∫–∞', '–±–µ–Ω–∑–∏–Ω',
        '–≤–∞–Ω—Ç—É–∑', '–≤–µ–¥—Ä–æ', '–≤–µ–Ω–∏–∫', '–≤–µ—à–∞–ª–∫–∞', '–≤–∫–ª–∞–¥—ã—à–∏', '–≥—É–±–∫–∞',
        '–¥–æ–∑–∞—Ç–æ—Ä', '–µ–º–∫–æ—Å—Ç—å', '–º—ã–ª–æ', '–∑–∞–≤–µ—Ä—Ç–∫–∞', '–ø–æ—Å—É–¥–æ–º–æ–µ—á–Ω—ã—Ö',
        '–ø–æ–¥—Å—Ç–∞–≤–∫–∞', '–∑—É–±–Ω–∞—è', '–∏–∑–º–µ–ª—å—á–∏—Ç–µ–ª—å', '—É–≥–æ–ª—å–Ω–∏–∫',
        '–∫–∞–º–Ω–µ–ª–æ–º–∫–∞', '–≤—ã–ø–µ—á–∫–∏', '–¥–ª—è —à—Ç–æ—Ä', '–∫–æ–º–ø–ª–µ–∫—Ç', '–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä',
        '–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä', '–∫–æ—Ä–∑–∏–Ω–∞', '–∫–æ—Ä–æ–±', '–∫–æ—Ñ—Ä', '–∫—Ä–µ–ø–µ–∂',
        '–∫—Ä—ã—à–∫–∞', '–∫—Ä—é—á–æ–∫', '–ø–æ–ª–æ—Ç–µ–Ω—Ü–µ', '–Ω–æ–∂–Ω–∏—Ü—ã', '–ª–∏–Ω–µ–π–∫–∞', 
        '–ø—Ä–∏—â–µ–ø–∫–∞', '–º—ã—Ç—å—è', '—à–≤–∞–±—Ä–∞', '–Ω–∞—Å–∞–¥–∫–∞', '–æ–∫–Ω–æ–º–æ–π–∫–∞', 
        '–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–±–∫–∏', '–ø–æ–ª–∏—Ä–æ–≤–∫–∞', '–∑—É–±', '–ø–µ–Ω–∞', 
        '–ø–µ—Ä—á–∞—Ç–∫–∞', '–ø–µ—Ç–ª—è', '–ø–ª–µ—á–∏–∫–∏', '–ø–æ–¥–≥–æ–ª–æ–≤–Ω–∏–∫', '–ø–æ–¥–∫–ª–∞–¥–∫–∞', 
        '–ø–æ–¥—Ä—É–∫–∞–≤–Ω–∏–∫', '–≥–ª–∞–¥–∏–ª—å–Ω–∞—è', '—Ü–≤–µ—Ç–Ω–∞—è —Ç—Ä—è–ø–∫–∞', '—Ñ–µ–Ω', '—Ñ–∏–∫—Å–∞—Ç–æ—Ä', 
        '—Å–≤–∞—Ä–∫–∞', '—á–∏—Å—Ç—è—â–∏–π', '—à–∏–ª–æ', '—à–Ω—É—Ä', '—à–ø–∞–≥–∞—Ç', '—à–ø–∏–Ω–≥–∞–ª–µ—Ç',
        '—à—Ç–∞–Ω–≥–µ–Ω—Ü–∏—Ä–∫—É–ª—å', '–ø—Ä–∏—â–µ–ø–∫–∏', '–≤–µ—Ä–µ–≤–∫–∞', '–≤–µ—à–∞–ª–∫–∏', '–≥–µ–ª—å –¥–ª—è —Å—Ç–∏—Ä–∫–∏', '—Ç—É–∞–ª–µ—Ç–Ω–æ–π',
        '–∫–æ–≤—à', '–¥—É–¥–∞–ª–µ–Ω–∏—è', '–ø–∞–∫–µ—Ç', '–º–µ—à–æ–∫', '–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç', '–º—ã–ª—å–Ω–∏—Ü–∞', '–≤–µ—à–∞–ª–æ–∫', '–Ω–∞–±–æ—Ä',
        '—Å–∞–ª—Ñ–µ—Ç–∫–∏', '–æ—Ç–∂–∏–º', '–æ—Ç–±–µ–ª–∏–≤–∞—Ç–µ–ª—å', '–ø–∞—Å—Ç–∞', '–ø–µ—Ä—á–∞—Ç–∫–∏', '–≥–ª–∞–¥–∏–ª—å–Ω–æ–π', '–ø—å–µ–∑–æ–∑–∞–∂–∏–≥–∞–ª–∫–∞',
        '–ø—Ä–æ–±–∫–∞', '—Ä–æ–ª–∏–∫', '—Å–≤–µ—Ä–ª–æ', 'c–µ—Ç–∫–∞', '—Ä–æ–ª–∏–∫–∞', '—Å–º–µ—Ç–∫–∞', '—Å–æ–≤–æ–∫', '–≥–ª–∞–∂–µ–Ω–∏—è', '—Å—Ç–∏—Ä–∫–∏', '—Å—Ä–µ–¥—Å—Ç–≤–æ',
        '–±–∏–æ–ø–æ—Ä–æ—à–æ–∫', '—Ç–∫–∞–Ω—å', '—Ç—Ä—è–ø–∫', '–º–∞—Å–∫–∞', '—Ñ–∞–ª')):
        return '–•–æ–∑—Ç–æ–≤–∞—Ä—ã'

    elif any(keyword in product_name for keyword in (
        '–≤–∞–∑–∞', '—Å–∫–∞—Ç–µ—Ä—Ç—å', '–ø–æ—Å—Ç–µ–ª—å–Ω–æ–µ', '–¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è',
        '–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è', '–∫–æ–≤—Ä–∏–∫', '–º—É–ª—è–∂', '–Ω–∞–≤–æ–ª–æ—á–∫–∞', '–Ω–∞–º–æ—Ä—Å—Ç–Ω–∏–∫',
        '–ø—Ä–æ—Å—Ç—ã–Ω—è', '–æ–¥–µ—è–ª–æ', '–ø–æ–¥—É—à–∫–∞', '–ø–æ–∫—Ä—ã–≤–∞–ª–æ', '—Å–∞–ª—Ñ–µ—Ç–∫–∞',
        '—Å–∫–∞—Ç–µ—Ä—Ç—å', '—á–µ—Ö–æ–ª', '—à—Ç–æ—Ä–∞', '–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π —Ü–≤–µ—Ç–æ–∫', '–∫–∞—Ä—Ç–∏–Ω–∞', '–∫–æ–≤—ë—Ä', '–Ω–∞–º–∞—Ç—Ä–∞—Å–Ω–∏–∫',
        '–Ω–∞–º–∞—Ç—Ä–∞—Ü–Ω–∏–∫', '—Ñ–ª–∏—Å–æ–≤—ã–π', '–∫–∞—à–ø–æ', '–ø–æ–¥–æ–¥–µ—è–ª—å–Ω–∏–∫', '–ø—Ä–æ—Å—Ç—ã–Ω—å', '—Ç–µ—Ä–º–æ–º–µ—Ç—Ä', '—Ñ–æ—Ç–æ—Ä–∞–º–∫–∞',
        '—Ü–≤–µ—Ç–æ–∫ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π')):
        return '–î–µ–∫–æ—Ä'

    elif any(keyword in product_name for keyword in (
        '–±–∞–∫', '–≤–∞–Ω–Ω–∞', '–≥–ª–∞–¥–∏–ª—å–Ω–∞—è', '–∫–∞—Ä–Ω–∏–∑', '–∫–æ—Ä—ã—Ç–æ', '–ª–µ—Å—Ç–Ω–∏—Ü–∞',  
        '—Å—É—à–∏–ª–∫–∞', '–æ–±—É–≤–Ω–∏—Ü–∞', '–ø–æ–ª–∫–∏', '–ø—ã–ª–µ—Å–æ—Å', '—Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫',
        '—Å–∏–¥–µ–Ω—å–µ', '–ø—É—Ñ', '—Å—Ç–µ–ª–ª–∞–∂', '—Å—Ç—Ä–µ–º—è–Ω–∫–∞', '—Å—É–º–∫–∞', '—Ç–∞–∑',
        '—Ç–µ–ª–µ–∂–∫–∞', '—É—Ä–Ω–∞', '—É—Ç—é–≥', '—Ö–∞–ª–∞—Ç', '—à—Ç–∞–Ω–≥–∞', '—ç—Ç–∞–∂–µ—Ä–∫–∞', '—è—â–∏–∫', '–≤–µ—Å—ã', '–∫–æ–º–æ–¥', '–∫–æ—Ä–∑–∏–Ω–∫–∞',
        '–ø–æ–ª–∫–∞', '–≤–µ–Ω—Ç–∏–ª—è—Ü–∏–æ–Ω–Ω–∞—è', '—Ä—É—á–∫–∞', '—Å—Ç—Ä–µ–º—è–Ω–∫–∏', '–æ–∫–æ–Ω–Ω–∞—è', '—É–≥–æ–ª–æ–∫')):
        return '–°–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞, –º–µ–±–µ–ª—å –∏ –ø—Ä–æ—á–∏–µ –ö–ì–¢'

    else:
        return '–†–∞—Å—Å–∞–¥–∞, —Ä–∞—Å—Ç–µ–Ω–∏—è, —Ü–≤–µ—Ç—ã'


# In[24]:


df['category'] = df['product'].apply(categorize_product)


# In[25]:


df['category'].value_counts()


# <div class="alert alert-success">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
#     
#   ‚úîÔ∏è –•–æ—Ä–æ—à–∞—è —Ä–∞–∑–±–∏–≤–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º. –ù–∞ –º–æ–π –≤–∑–≥–ª—è–¥, –æ–ø—Ç–∏–º–∞–ª—å–Ω–µ–µ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å.
# 
# </div>
#  <div class="alert alert-warning">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
#     
#   ‚ö†Ô∏è –°—Ç–æ–∏—Ç –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –Ω–∏—Ö.
#     
# </div>

# In[26]:


# –ø–æ—Å—á–∏—Ç–∞–µ–º –∏—Ç–æ–≥–æ–≤—É—é —Å—É–º–º—É –ø–æ —Ç–æ–≤–∞—Ä—É –≤ –∑–∞–∫–∞–∑–µ
df['total_price'] = df['quantity'] * df['price']
df['total_price'] = df['total_price'].astype(int) 

# –≤—ã–¥–µ–ª–∏–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
df['month'] = df['date'].dt.to_period('M')
df['day_of_week'] = df['date'].dt.day_name()
df['hour'] = df['date'].dt.hour


# **–í—ã–≤–æ–¥:**
# 
# 1. 2 —Å—Ç–æ–ª–±—Ü–∞ –±—ã–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã: —Å—Ç–æ–ª–±–µ—Ü date –≤ —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã, –∞ product (–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞) —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Å –∑–∞–≥–ª–∞–≤–Ω–æ–π –±—É–∫–≤—ã
# 2. –ë—ã–ª–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã , –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –≤—ã–∑–≤–∞–Ω—ã –Ω–µ—è–≤–Ω—ã–º–∏ –¥—É–±–ª—è–º–∏ –≤ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è—Ö —Ç–æ–≤–∞—Ä–∞. –î–ª—è —ç—Ç–æ–≥–æ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä subset –±—ã–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω—ã —Å—Ç–æ–ª–±—Ü—ã order_id (—Ç–∞–∫ –∫–∞–∫ —Å–∞–º–æ –ø–æ —Å–µ–±–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è –º–æ–∂–µ—Ç, —Ç–∞–∫ –∫–∞–∫ –µ–≥–æ –º–æ–≥–ª–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –∑–∞–∫–∞–∑–∞—Ö –ø—Ä–∏–æ–±—Ä–µ—Ç–∞—Ç—å) –∏ products_dupl_check (—Å—Ç–æ–ª–±–µ—Ü —Å —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è–º–∏)
# 3. –ü–æ —Å—Ç–æ–ª–±—Ü—É order_id –∑–Ω–∞—á–µ–Ω–∏—è –±—ã–ª–∏ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –≤ –∞–±—Å–æ–ª—é—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ —Ç–∞–∫–∏–µ –æ–ø–µ—á–∞—Ç–∫–∏ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ –±—ã–ª–∏
# 4. –ë—ã–ª–∏ –∏–∑—É—á–µ–Ω—ã –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã –∞–Ω–æ–º–∞–ª–∏–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∏ –ø—Ä–∞–π—Å—É —Ç–æ–≤–∞—Ä–æ–≤. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º: 
#    - —É–¥–∞–ª–∏–ª–∏ –æ–¥–∏–Ω –∑–∞–∫–∞–∑ —Å 1000 –≤–∞–Ω—Ç—É–∑–∞–º–∏. –ü—Ä–æ—á–∏–µ –∑–∞–∫–∞–∑—ã —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ç–æ–≤–∞—Ä–æ–≤ –Ω–µ –≤—ã–≥–ª—è–¥—è—Ç –∞–Ω–æ–º–∞–ª—å–Ω–æ - –≤–ø–æ–ª–Ω–µ –ª–æ–≥–∏—á–Ω–æ –ø—Ä–∏–æ–±—Ä–µ—Ç–∞—Ç—å "—Ä–∞—Å—Ö–æ–¥–Ω–∏–∫–∏", —Ç–∏–ø–∞ –≤–µ—à–∞–ª–æ–∫ –∏ —Å—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤, –≤ —Ç–∞–∫–∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞—Ö
#    - —Å–∞–º—ã–µ –¥–µ—à–µ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã - —ç—Ç–æ —Ä–∞—Å—Å–∞–¥–∞. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∞–Ω–æ–º–∞–ª–∏–∏ –Ω–µ—Ç, —Ç–∞–∫ –∫–∞–∫ —Ä–∞—Å—Å–∞–¥–∞ –æ–±—ã—á–Ω–æ —Ç–∞–∫ –∏ —Å—Ç–æ–∏—Ç
#    - –¢–û–ü –¥–æ—Ä–æ–≥–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤—ã–≥–ª—è–¥–∏—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ, –Ω–æ —Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∏—Ö —Ä–µ–∞–ª—å–Ω–æ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ–∫–∞–∑–∞–ª–∞, —á—Ç–æ –ø—Ä–∞–π—Å —ç—Ç–æ—Ç —Ä–µ–∞–ª–µ–Ω. –ó–Ω–∞—á–µ–Ω–∏—è –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –ø—Ä–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ "—Å–≥–ª–∞–¥–∏–º" —Å –ø–æ–º–æ—â—å—é –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è–º–∏, –æ–¥–Ω–∞–∫–æ –∞–Ω–æ–º–∞–ª–∏—è–º–∏ –æ–Ω–∏ –Ω–µ —è–≤–ª—è—é—Ç—Å—è
# 5. –ë—ã–ª–∏ –≤—Ä—É—á–Ω—É—é –≤—ã–≤–µ–¥–µ–Ω—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤. –î–ª—è —ç—Ç–æ–≥–æ –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –±—ã–ª–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω—ã, –∞ —Å–ª–æ–≤–∞-–∫–ª—é—á–∏ –±—ã–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–ª–∞ –±—ã –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Ç–æ–≤–∞—Ä–∞. –£—Å–ª–æ–≤–Ω–æ , —Ç–æ–≤–∞—Ä—ã –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ 5 –∫–∞—Ç–µ–≥–æ—Ä–∏–π: —Ä–∞—Å—Å–∞–¥–∞ –∏ –ø—Ä–æ—á–∏–µ —Ä–∞—Å—Ç–µ–Ω–∏—è, –∫—Ä—É–ø–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã, –º–µ–ª–∫–∏–µ —Ö–æ–∑—Ç–æ–≤–∞—Ä—ã, –¥–µ–∫–æ—Ä –∏ –ø–æ—Å—É–¥–∞. –ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ –≤ –º–∞—Ç—Ä–∏—Ü–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ä–∞—Å—Å–∞–¥—ã - –ø–æ—á—Ç–∏ –ø–æ–ª–æ–≤–∏–Ω–∞ –æ—Ç –≤—Å–µ–π –≤—ã–±–æ—Ä–∫–∏. –ú–µ–Ω—å—à–µ –≤—Å–µ–≥–æ - –ø–æ—Å—É–¥—ã
# 6. –î–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è —Å—Ç–æ–ª–±—Ü—ã –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º, –ø–æ—ç—Ç–æ–º—É –±—ã–ª —Å–æ–∑–¥–∞–Ω —Å—Ç–æ–ª–±–µ—Ü —Å –º–µ—Å—è—Ü–µ–º, –¥–Ω–µ–º –Ω–µ–¥–µ–ª–∏ –∏ —á–∞—Å–æ–º –∑–∞–∫–∞–∑–∞

# <div class="alert alert-success">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
#     
#   ‚úîÔ∏è –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã.
#  
# </div>

# ### –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

# In[27]:


# –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ–∫—É–ø–æ–∫ –ø–æ –º–µ—Å—è—Ü–∞–º
monthly_summary = df.groupby('month').agg(
   total_orders=('order_id', 'nunique'),
   total_revenue=('total_price', 'sum')
).reset_index()

monthly_summary['total_revenue'] = monthly_summary['total_revenue'] / 1000000

# –ì—Ä–∞—Ñ–∏–∫ –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤
plt.figure(figsize=(12, 6))
plt.plot(monthly_summary['month'].astype(str), monthly_summary['total_orders'], label='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤', marker='o')
plt.xlabel('–ú–µ—Å—è—Ü')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')
plt.title('–î–∏–Ω–∞–º–∏–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º')
plt.xticks(rotation=45)
plt.grid()
plt.show()

# –ì—Ä–∞—Ñ–∏–∫ –¥–ª—è —Å—É–º–º –∑–∞–∫–∞–∑–æ–≤
plt.figure(figsize=(12, 6))
plt.plot(monthly_summary['month'].astype(str), monthly_summary['total_revenue'], label='–í—ã—Ä—É—á–∫–∞ –≤ –º–ª–Ω', marker='o')
plt.xlabel('–ú–µ—Å—è—Ü')
plt.ylabel('–í—ã—Ä—É—á–∫–∞ (–º–ª–Ω)')
plt.title('–î–∏–Ω–∞–º–∏–∫–∞ –≤—ã—Ä—É—á–∫–∏ –ø–æ –º–µ—Å—è—Ü–∞–º')
plt.xticks(rotation=45)
plt.grid()
plt.show()


# **–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥**
# 
# 1. –ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ, –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É—é—â–µ–º –¥–∏–Ω–∞–º–∏–∫—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º, –º–æ–∂–Ω–æ –Ω–∞–±–ª—é–¥–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏: –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –±—ã–ª–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –≤ –¥–µ–∫–∞–±—Ä–µ 2018 –≥–æ–¥–∞ –∏ –≤ —Ñ–µ–≤—Ä–∞–ª–µ 2019 –≥–æ–¥–∞ - –±–æ–ª—å—à–µ 280 –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –º–µ—Å—è—Ü. –ó–∞–º–µ—Ç–Ω–æ, —á—Ç–æ –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –º–µ—Å—è—Ü–∞–º–∏ –≤ —è–Ω–≤–∞—Ä–µ 2019 –±—ã–ª —Ä–µ–∑–∫–∏–π —Å–ø–∞–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ - —á—É—Ç—å –±–æ–ª–µ–µ 160 –∑–∞–∫–∞–∑–æ–≤. –≠—Ç–æ—Ç —Ä–µ–∑–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –≤–ª–∏—è–Ω–∏–µ –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤ –∏ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å —Å–ø—Ä–æ—Å–∞ –≤ –¥–µ–∫–∞–±—Ä–µ (–Ω–æ–≤–æ–≥–æ–¥–Ω–∏–µ) –∏ —Ñ–µ–≤—Ä–∞–ª–µ (–≥–µ–Ω–¥–µ—Ä–Ω—ã–µ). –ù–∞ —Å–ª–µ–¥—É—é—â–∏–π –≥–æ–¥ –∫–∞—Ä—Ç–∏–Ω–∞ –Ω–µ–º–Ω–æ–≥–æ –∏–Ω–∞—è - –ø—Ä–æ–≤–∞–ª–∞ –≤ —è–Ω–≤–∞—Ä–µ –Ω–µ—Ç. –ó–∞–º–µ—Ç–Ω–æ, —á—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –∑–∏–º–Ω–µ-–≤–µ—Å–µ–Ω–Ω–∏–π –ø–µ—Ä–∏–æ–¥. –í –º–∞–µ –≤–∏–¥–Ω–æ —Ä–µ–∑–∫–∏–π –æ–±–≤–∞–ª –∫–æ–ª-–≤–∞ –∑–∞–∫–∞–∑–æ–≤: —Å 260+ –∑–∞–∫–∞–∑–æ–≤ –≤ –∞–ø—Ä–µ–ª–µ –¥–æ 180 –≤ –º–∞–µ –í–æ–∑–º–æ–∂–Ω–æ, –¥–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–∫–∞–∑—ã–≤–∞—é—Ç —Ä–∞—Å—Å–∞–¥—É, –∞ –≤ –º–∞–µ –µ–µ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç —Å–∞–∂–∞—Ç—å
# 2. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã—Ä—É—á–∫–∏, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ –º–µ—Å—è—Ü–∞–º, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–π —Ç—Ä–µ–Ω–¥ - –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ –∑–∏–º–æ–π 2019 –≥–æ–¥–∞ –º—ã –∏–º–µ–µ–º —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏. –≠—Ç–æ –º–æ–∂–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—Ç—å –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, —á—Ç–æ —ç—Ç–∏ –∑–∞–∫–∞–∑—ã –ø—Ä–∏—à–ª–∏—Å—å –Ω–∞ —Ä–∞—Å—Å–∞–¥—É, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–¥–∞–µ—Ç—Å—è –ø–æ –Ω–∏–∑–∫–æ–π —Ü–µ–Ω–µ. –í–µ—Ä–æ—è—Ç–Ω–æ, –∫–æ–º–ø–∞–Ω–∏—è –∑–Ω–∞–µ—Ç –∫–∞–∫ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–¥–æ—Ä–æ–≥–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤, –∞ —Å–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π –ø—Ä–æ–¥–∞–∂–∏ –±–æ–ª–µ–µ –¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–∏—Ö –æ—Ç –º–µ—Å—è—Ü—É –∫ –º–µ—Å—è—Ü—É —É –∫–æ–º–ø–∞–Ω–∏–∏ —Å—Ç–∞–Ω–æ–≤–∏–ª–æ—Å—å –≤—Å–µ —Ö—É–∂–µ. –ù–∞–∏–≤—ã—Å—à–∞—è –≤—ã—Ä—É—á–∫–∞  –≤ –Ω–æ—è–±—Ä–µ 2018 –≥–æ–¥–∞ —Å –∑–Ω–∞—á–µ–Ω–∏–µ–º 0.35+ –º–ª–Ω, –æ–¥–Ω–∞–∫–æ, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø–∏–∫–æ–≤–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –≤ –¥–µ–∫–∞–±—Ä–µ, –∑–¥–µ—Å—å –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –∑–∞–º–µ—Ç–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –≤ —è–Ω–≤–∞—Ä–µ 2019 –¥–æ 0.23+ –º–ª–Ω. –§–µ–≤—Ä–∞–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–±–æ–ª—å—à–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ –≤—ã—Ä—É—á–∫–µ, –¥–æ—Å—Ç–∏–≥–Ω—É–≤ 0.3+ –º–ª–Ω, –∑–∞—Ç–µ–º –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥ –∫–æ–ª–µ–±–∞–Ω–∏–π —Å –æ—á–µ—Ä–µ–¥–Ω—ã–º–∏ –º–∏–Ω–∏-–ø–∏–∫–∞–º–∏ ‚Äì –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –∞–ø—Ä–µ–ª–µ (0.315+ –º–ª–Ω) –∏ –¥–µ–∫–∞–±—Ä–µ 2019 –≥–æ–¥–∞ (0.2+ –º–ª–Ω), –æ–¥–Ω–∞–∫–æ –≤ —Ü–µ–ª–æ–º –≤—ã—Ä—É—á–∫–∞ –≤ —ç—Ç–∏ –º–µ—Å—è—Ü—ã –æ—Å—Ç–∞–µ—Ç—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∂–µ, —á–µ–º –≤ –ø–µ—Ä–∏–æ–¥ –∫–æ–Ω–µ—Ü 2018 ‚Äì –Ω–∞—á–∞–ª–æ 2019 –≥–æ–¥–∞.
# 
# –ù–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç –Ω–µ —è—Å–Ω–æ, —á—Ç–æ –µ—â–µ –º–æ–≥–ª–æ –ø–æ—Å–ª—É–∂–∏—Ç—å –ø—Ä–∏—á–∏–Ω–æ–π —Ç–∞–∫–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–∞–ª–µ–µ –ø—Ä–æ–≤–æ–¥–∏—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

# <div class="alert alert-success">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
#     
#   ‚úîÔ∏è –î–µ–ª–∞ —É –º–∞–≥–∞–∑–∏–Ω–∞ –∏–¥—É—Ç –≤—Å–µ —Ö—É–∂–µ.
#  
# </div>

# In[28]:


#  –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–∫—É–ø–æ–∫ –∏ —Å—É–º–º –ø–æ –∑–∞–∫–∞–∑–∞–º
plt.figure(figsize=(12, 6))

# –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—É–º–º –∑–∞–∫–∞–∑–æ–≤
plt.subplot(1, 2, 1)
plt.hist(df['total_price'], bins=5000, color='blue', alpha=0.7)
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—É–º–º –∑–∞–∫–∞–∑–æ–≤')
plt.xlim(0, 6000)  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥–µ–ª—ã
plt.ylim(0, 300)  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥–µ–ª—ã
plt.xlabel('–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞')
plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')

# –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤
plt.subplot(1, 2, 2)
plt.hist(df['quantity'], bins=500, color='red', alpha=0.7)
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ')
plt.xlim(0, 100)  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥–µ–ª—ã
plt.ylim(0, 200)  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥–µ–ª—ã
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤')
plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')

plt.tight_layout()
plt.show()


# **–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥:**
# 
# –ü–æ—Å—Ç—Ä–æ–∏–ª–∏ –≥—Ä–∞—Ñ–∏–∫–∏ —Å –±–∏–Ω–∞–º–∏ –ø–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é —Å—É–º–º –∑–∞–∫–∞–∑–∞ –∏ –∫–æ–ª-–≤—É —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ. –í–æ—Ç —á—Ç–æ –º–æ–∂–Ω–æ –∑–∞–∫–ª—é—á–∏—Ç—å:
# 
# 1. –ù–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ, —á—Ç–æ –∫–æ–º–ø–∞–Ω–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ø—Ä–æ–¥–∞–∂–µ –¥–µ—à–µ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤. –≠—Ç–æ –µ—â–µ —Ä–∞–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–æ–≤ - —ç—Ç–æ —Å–µ–º–µ–Ω–∞
# 2. –ü–æ–¥–∞–≤–ª—è—é—â–µ–µ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∏–º–µ–µ—Ç —Å—É–º–º—É –Ω–µ –±–æ–ª–µ–µ 250 —Ä—É–±–ª–µ–π. –ü–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–∫–∞–∑—ã–≤–∞—é—Ç –≤—Å–µ –∂–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –Ω–µ –±–æ–ª–µ–µ 5 —Ç–æ–≤–∞—Ä–æ–≤ (–µ–¥–∏–Ω–∏—Ü) –≤ –∑–∞–∫–∞–∑–µ
# 
# *–ò–∑-–∑–∞ –º–Ω–æ–≥–æ—á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞–∫–∞–∑–æ–≤ –∏–∑ –¥–æ–º–∏–Ω–∞–Ω—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã –≥—Ä–∞—Ñ–∏–∫–∏ –±—ã–ª–∏ –æ–±—Ä–µ–∑–∞–Ω—ã –ø–æ –æ—Å–∏ –£ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏*
# 
# –ò–∑—É—á–∏–º –ø–æ–¥—Ä–æ–±–Ω–µ–µ —Ü–µ–Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
# 

# In[29]:


# –ê–Ω–∞–ª–∏–∑ –ø–æ —Ü–µ–Ω–æ–≤—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

plt.figure(figsize=(12, 6))
sns.boxplot(y=df['price'])
plt.title('–ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π')
plt.ylabel('–¶–µ–Ω–∞')
plt.grid()
plt.show()

# —Å –ª–∏–º–∏—Ç–∞–º–∏

plt.figure(figsize=(12, 6))
sns.boxplot(y=df['price'])
plt.title('–ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π')
plt.ylim(0, 2500)  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥–µ–ª—ã
plt.ylabel('–¶–µ–Ω–∞')
plt.grid()
plt.show()


# **–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥:**
# 
# –ë—ã–ª –ø–æ—Å—Ç—Ä–æ–µ–Ω –±–æ–∫—Å–ø–ª–æ—Ç –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ü–µ–Ω–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤. –í–æ—Ç —á—Ç–æ –º–æ–∂–Ω–æ –∑–∞–∫–ª—é—á–∏—Ç—å:
# 
# 1. –í—ã–±—Ä–æ—Å—ã –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –æ—Ç –≥—Ä–∞–Ω–∏—Ü—ã –≤ 1200 —Ä—É–±–ª–µ–π. –í—Å–µ —Ü–µ–Ω—ã –¥–æ —ç—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å "–Ω–æ—Ä–º–∞–ª—å–Ω—ã–º–∏"
# 2. –í—ã–±—Ä–æ—Å—ã –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ —Ç—è–Ω—É—Ç—Å—è –æ—Ç –≥—Ä–∞–Ω–∏—Ü—ã –≤ 1200 —Ä—É–±–ª–µ–π –¥–æ 9000 —Ä—É–±–ª–µ–π, –æ–¥–Ω–∞–∫–æ —á–µ–º –≤—ã—à–µ - —Ç–µ–º —Ä–µ–∂–µ –æ–Ω–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã–±—Ä–æ—Å—ã —Ä–µ–∑–∫–æ –ø—Ä–µ–∫—Ä–∞—â–∞—é—Ç—Å—è
# 3. –ò–º–µ–µ—Ç—Å—è –æ–¥–∏–Ω –≤—ã–±—Ä–æ—Å —Å –ø—Ä–∞–π—Å–æ–º –±–æ–ª–µ–µ 14000 —Ä—É–±–ª–µ–π 

# In[30]:


# –ê–Ω–∞–ª–∏–∑ –ø–∏–∫–æ–≤—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ –ø–æ–∫—É–ø–æ–∫
heatmap_data = df.groupby(['day_of_week', 'hour'])['order_id'].nunique().unstack(fill_value=0)

# –°–æ–∑–¥–∞–µ–º –≥—Ä–∞—Ñ–∏–∫ —Ö–∏—Ç–º—ç–ø–∞
plt.figure(figsize=(12, 6))
sns.heatmap(heatmap_data, cmap='YlGnBu', annot=True, fmt="d")
plt.title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏ –∏ —á–∞—Å–∞–º')
plt.xlabel('–ß–∞—Å')
plt.ylabel('–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏')
plt.yticks(rotation=20)  # –í—Ä–∞—â–µ–Ω–∏–µ –º–µ—Ç–æ–∫ –ø–æ –æ—Å–∏ Y
plt.show()


# **–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥:**
# 
# –ë—ã–ª –ø–æ—Å—Ç—Ä–æ–µ–Ω —Ö–∏—Ç–º—ç–ø –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–∏–∫–æ–≤—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ –ø—Ä–æ–¥–∞–∂ (–ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏ –∏ —á–∞—Å–∞–º). –ò–∑ –≥—Ä–∞—Ñ–∏–∫–∞ –≤–∏–¥–∏–º, —á—Ç–æ:
# 
# 1. –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç—Å—è —Å 9 –¥–æ 16 —á–∞—Å–æ–≤ –≤–æ –≤—Å–µ –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏, –∫—Ä–æ–º–µ —Å—É–±–±–æ—Ç—ã. –í —ç—Ç–æ—Ç –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –≤—Ä–µ–º—è –ø–æ–∫—É–ø–æ–∫ —Å–¥–≤–∏–≥–∞–µ—Ç—Å—è –±–ª–∏–∂–µ –∫ –≤–µ—á–µ—Ä—É - –∑–∞–∫–∞–∑—ã–≤–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–µ–µ –Ω–∞—á–∏–Ω–∞—é—Ç –≤ 16 —á–∞—Å–æ–≤
# 2. –°–∞–º—ã–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –¥–ª—è –∑–∞–∫–∞–∑–æ–≤ –¥–Ω–∏ - –±—É–¥–Ω–∏–µ –¥–Ω–∏. –£–∂–µ –≤ –ø—è—Ç–Ω–∏—Ü—É –≤–∏–¥–Ω–æ —Å–Ω–∏–∂–µ–Ω–∏–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∑–∞–∫–∞–∑–æ–≤, –≤ —Å—É–±–±–æ—Ç—É –∏—Ö –≤–æ–≤—Å–µ –º–µ–Ω—å—à–µ –≤—Å–µ–≥–æ, –∞ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ - –ø–æ—á—Ç–∏ –Ω–∞ —Ç–æ–º –∂–µ —É—Ä–æ–≤–Ω–µ , —á—Ç–æ –∏ –ø—è—Ç–Ω–∏—Ü–∞. –í –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –∑–∞–∫–∞–∑—ã –ø—Ä–∏–¥–≤–∏–≥–∞—é—Ç—Å—è –∫ –ø—Ä–∏–≤—ã—á–Ω–æ–π –≤—ã—Å–æ–∫–æ–π –æ—Ç–º–µ—Ç–∫–µ (–≤ —Å—Ä–µ–¥–Ω–µ–º, 40 –∑–∞–∫–∞–∑–æ–≤ –≤ —á–∞—Å) –≤ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫

# <div class="alert alert-success">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
#     
#   ‚úîÔ∏è –ù–µ –æ—á–µ–Ω–± –ø–æ—Ö–æ–∂–∞ –Ω–∞ –¥–∞—á–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω—á–∏–∫.
#  
# </div>

# In[31]:


# –†–∞—Å—á–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
correlation_matrix = df.corr()

plt.figure(figsize=(12, 8))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', fmt=".2f")
plt.title('–ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π')
plt.show()


# **–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥**
# 
# –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å , –ø–æ –∫–∞–∫–∏–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º –ø—Ä–æ–≤–µ—Å—Ç–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, –µ–µ —Ä–æ–ª—å –±–æ–ª—å—à–µ –≤ –∏–∑—É—á–µ–Ω–∏–∏ —Å—Ç–µ–ø–µ–Ω–∏ —ç—Ç–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –≤—ã–±–æ—Ä–∫–µ –Ω–µ —Ç–∞–∫ –º–Ω–æ–≥–æ. –ò—Ç–∞–∫,
# 
# - —É–±–µ–∂–¥–∞–µ–º—Å—è , —á—Ç–æ —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞ –ø—Ä—è–º–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å –ø—Ä–∞–π—Å–æ–º —Ç–æ–≤–∞—Ä–∞ (60% –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏)
# - —á—É—Ç—å –º–µ–Ω–µ–µ, –Ω–æ –≤—Å–µ —Ä–∞–≤–Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–∏–ª—å–Ω–æ (40% –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏) —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫—É–ø–ª–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤

# **–ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥**
# 
# –í —Ö–æ–¥–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∏ –≤—ã—è–≤–ª–µ–Ω—ã –≤–∞–∂–Ω—ã–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏ –∏ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–º –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è—Ö –∫–æ–º–ø–∞–Ω–∏–∏. 
# 
# 1. –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –∑–∞–∫–∞–∑–æ–≤: –ù–∞–∏–±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–µ –æ–±—ä–µ–º—ã —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –ø—Ä–∏—Ö–æ–¥—è—Ç—Å—è –Ω–∞ –¥–µ–∫–∞–±—Ä—å 2018 –∏ —Ñ–µ–≤—Ä–∞–ª—å 2019 –≥–æ–¥–∞, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–º–∏ —Å–µ–∑–æ–Ω–∞–º–∏. –í —è–Ω–≤–∞—Ä–µ 2019 –≥–æ–¥–∞ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Ä–µ–∑–∫–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤, –æ–¥–Ω–∞–∫–æ –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –¥–∏–Ω–∞–º–∏–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π. –í–µ—Å–µ–Ω–Ω–∏–π –ø–µ—Ä–∏–æ–¥ —Ç–∞–∫–∂–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å –ø—Ä–æ–¥–∞–∂–µ–π —Ä–∞—Å—Å–∞–¥—ã, —Ç–æ–≥–¥–∞ –∫–∞–∫ –ª–µ—Ç–Ω–∏–µ –º–µ—Å—è—Ü—ã —Ñ–∏–∫—Å–∏—Ä—É—é—Ç –ø–∞–¥–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å–∞ –∫ –∑–∞–∫–∞–∑–∞–º.
# 
# 2. –í—ã—Ä—É—á–∫–∞ –∏ —Ü–µ–Ω–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è: –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –≤—ã—Å–æ–∫–∏–π –æ–±—ä–µ–º –∑–∞–∫–∞–∑–æ–≤ –≤ –∑–∏–º–Ω–∏–µ –º–µ—Å—è—Ü—ã, –≤—ã—Ä—É—á–∫–∞ –∫–æ–º–ø–∞–Ω–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã, —É–∫–∞–∑—ã–≤–∞—è –Ω–∞ –ø—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ –Ω–µ–¥–æ—Ä–æ–≥–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–∞—Ö. –ù–∞–∏–≤—ã—Å—à–∞—è –≤—ã—Ä—É—á–∫–∞ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –≤ –Ω–æ—è–±—Ä–µ, –Ω–æ –≤ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –º–µ—Å—è—Ü–∞—Ö –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Å–Ω–∏–∂–µ–Ω–∏–µ, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, —á—Ç–æ –∫–æ–º–ø–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ —Å–±—ã–≤–∞–µ—Ç –±—é–¥–∂–µ—Ç–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏, –∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –ø—Ä–æ–¥–∞–∂ –±–æ–ª–µ–µ –¥–æ—Ä–æ–≥–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏.
# 
# 3. –•–∞—Ä–∞–∫—Ç–µ—Ä –∑–∞–∫–∞–∑–∞: –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∏–º–µ–µ—Ç –Ω–∏–∑–∫—É—é —Å—É–º–º—É, –Ω–µ –ø—Ä–µ–≤—ã—à–∞—é—â—É—é 250 —Ä—É–±–ª–µ–π, –∏, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ–±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤ (–¥–æ 5 –µ–¥–∏–Ω–∏—Ü). –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –∫–æ–º–ø–∞–Ω–∏—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –º–∞—Å—Å–æ–≤—ã–π —Ä—ã–Ω–æ–∫ —Å –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Ü–µ–Ω–æ–≤—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏.
# 
# 5. –ü–∏–∫–æ–≤—ã–µ —á–∞—Å—ã –∏ –¥–Ω–∏ –¥–ª—è –∑–∞–∫–∞–∑–æ–≤: –û—Å–Ω–æ–≤–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ–∫—É–ø–æ–∫ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –±—É–¥–Ω–∏–µ –¥–Ω–∏, —Å –ø–∏–∫–∞–º–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å 9 –¥–æ 16 —á–∞—Å–æ–≤. –í —Å—É–±–±–æ—Ç—É –ø–æ–∫—É–ø–∫–∏ —Å–º–µ—â–∞—é—Ç—Å—è –Ω–∞ –≤–µ—á–µ—Ä–Ω–µ–µ –≤—Ä–µ–º—è, –∞ –≤ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –æ–±—â–µ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤. –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –≤ –ø–∏–∫–æ–≤—ã–µ —á–∞—Å—ã.
# 
# 6. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π: –í—ã—è–≤–ª–µ–Ω–Ω–∞—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É —Å—É–º–º–æ–π –∑–∞–∫–∞–∑–∞ –∏ —Ü–µ–Ω–æ–π —Ç–æ–≤–∞—Ä–∞ (60%) –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ (40%) –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å —ç—Ç–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø—Ä–æ–¥–∞–∂.

# ### –ö–ª–∞—Å—Ç–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑

# In[32]:


# df.groupby(by='customer_id')['order_id'].nunique().sort_values(ascending=False)


# In[33]:


# # –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—á–∏—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –û—Ç–¥–µ–ª–∏–º —Ç–æ–≤–∞—Ä—ã, —Ü–µ–Ω–∞ –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∞—è —Ü–µ–Ω–∞ 

# upper_bound = 10000

# df = df[df['price'] <= upper_bound]


# <div class="alert alert-danger">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
#     
#   ‚ùå –û–±—Ä–µ–∑–∞—Ç—å –ø–æ –ø—Ä–∞–π—Å—É –Ω–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ú—ã —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ —Ç–µ—Ä—è–µ–º —Å–∞–º—ã–µ –¥–æ—Ä–æ–≥–∏–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ –∞–Ω–∞–ª–∏–∑–∞. –í—ã–±—Ä–æ—Å—ã —Å—Ç–æ–∏—Ç —Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ —á–µ–∫—É –ø–æ–∫—É–ø–∫–∏. –ü–æ –Ω–∏–∂–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü–µ –º—ã –≤–æ–æ–±—â–µ –Ω–µ —Ç—Ä–æ–≥–∞–µ–º –≤—ã–±—Ä–æ—Å—ã, —É –º–∞–≥–∞–∑–∏–Ω–∞ –µ—Å—Ç—å –¥–µ—à–µ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã –∏ –≤—ã–∫–∏–¥—ã–≤–∞—Ç—å –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∏—Ö –º—ã –Ω–µ –º–æ–∂–µ–º.
# </div>

# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
#     
#   –£–±—Ä–∞–ª–∏ –Ω–∏–∂–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É, –ø—Ä–∞–π—Å –∑–∞–º–µ–Ω–∏–ª–∏ –Ω–∞ —á–µ–∫
# </div>

# <div class="alert alert-danger">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ v.2</b>
#     
#   ‚ùå –ú—ã —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–æ –æ–±—Ä–µ–∑–∞–µ–º –≤—ã–±—Ä–æ—Å—ã –ø–æ —á–µ–∫—É, —É –Ω–∞—Å –µ—Å—Ç—å —Ç–æ–≤–∞—Ä—ã —Å —Ü–µ–Ω–æ–π —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –≤—ã—à–µ 1649.
# </div>

# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞ 2</b>
#     
#   –ú–æ–∂–Ω–æ –≤–∑—è—Ç—å 99–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å, –æ–Ω –Ω–µ —Å–∏–ª—å–Ω–æ –ø–æ—Ä–µ–∂–µ—Ç –¥–∞–Ω–Ω—ã–µ. –ü–æ –±–æ–∫—Å–ø–ª–æ—Ç—É –ø–æ—Å–ª–µ 6000 –≤—ã–±—Ä–æ—Å—ã –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –∏–¥—Ç–∏ –Ω–æ–Ω-—Å—Ç–æ–ø. 99—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å —Ç–æ–∂–µ —Å–≤–æ–µ–≥–æ —Ä–æ–¥–∞ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞. –û–±—ã—á–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—é—Ç 95—ã–π –∏ 99—ã–π, –≤–æ—Ç 95—ã–π —Ç–æ–∂–µ –∏–º–µ–µ—Ç —Ü–µ–Ω—É —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∏–∂–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –∏–º–µ—é—â–∏–º–∏—Å—è –≤ —Ñ—Ä–µ–π–º–µ —á–µ–∫–∞–º–∏.
# </div>
# <div class="alert alert-danger">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ v.3</b>
#     
#   ‚ùå –ü–æ—Å–º–æ—Ç—Ä–∏ –∫–∞–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —É –Ω–∞—Å –ø–æ 99 –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—é —á–µ–∫–∞ –∏ –∫–∞–∫–æ–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∞–π—Å. –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ —á–∞—Å—Ç–æ —Ä–µ–∂—É –Ω–µ –ø–æ –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—è–º, –∞ –ø–æ—Å–º–æ—Ç—Ä–µ–≤ boxplot –∏–ª–∏ —Ç–æ–ø-5 –∏–ª–∏ —Ç–æ–ø-10 –∏ –ø—Ä–∏–Ω–∏–º–∞—è —Ä–µ—à–µ–Ω–∏—è –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º.
#     
# –ò –≤—ã–±—Ä–æ—Å—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –ø–æ —á–µ–∫—É, –ø–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—é.
# </div>

# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞ 3</b>
#     –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∞–π—Å 14000, —É–±–∏—Ä–∞—é –µ–≥–æ –∏–∑ —Ñ—Ä–µ–π–º–∞. 126 –∑–∞–∫–∞–∑–æ–≤ –∑–∞ –≥–æ–¥ - –≤–ø–æ–ª–Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
# 
# </div>
# <div class="alert alert-danger">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ v.4</b>
#     
#   ‚ùå –ú—ã —á–µ–∫ –æ–±—Ä–µ–∑–∞–µ–º –ø–æ 10000, —Ç.–µ. —Ç–µ—Ä—è–µ–º —Ç–æ–≤–∞—Ä—ã –æ—Ç 10000 –¥–æ 14000, —á—Ç–æ –Ω–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ü–ª—é—Å —Ç–æ–≤–∞—Ä–æ–≤ —Ü–µ–Ω–æ–π 14000 –º–æ–≥—É—Ç –≤–∑—è—Ç—å 2-3, —Ç.–µ. —ç—Ç–æ –∑–∞–∫–∞–∑—ã –Ω–µ –ø–æ—Ö–æ–∂–∏ –Ω–∞ –≤—ã–±—Ä–æ—Å—ã –Ω–æ –º—ã –∏—Ö —Ç–∞–∫-–∂–µ –≤—ã–∫–∏–¥—ã–≤–∞–µ–º. –£ –Ω–∞—Å —Å–µ–π—á–∞—Å –≤ –∞–Ω–∞–ª–∏–∑–µ –Ω–µ—Ç –Ω–µ –æ–¥–Ω–æ–≥–æ "—Ö–æ—Ä–æ—à–µ–≥–æ" –∫–ª–∏–µ–Ω—Ç–∞ - –ø–æ–∫—É–ø–∞—é—â–µ–≥–æ –¥–æ—Ä–æ–≥–∏–µ —Ç–æ–≤–∞—Ä—ã –∏–ª–∏ –º–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤.
# </div>

# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞ 4</b>
#     
#   –¢–æ–≥–¥–∞ —è –≤–æ–æ–±—â–µ –Ω–µ –≤–∏–∂—É —Å–º—ã—Å–ª–∞ —á—Ç–æ –ª–∏–±–æ –æ–±—Ä–µ–∑–∞—Ç—å. –ú—ã —É–∂–µ –æ–±—Ä–µ–∑–∞–ª–∏ –æ–¥–Ω—É –µ–¥–∏—Å–Ω—Ç–≤–µ–Ω–Ω—É—é –∞–Ω–æ–º–∞–ª–∏—é –≤ —Å–∞–º–æ–º –≤–µ—Ä—Ö—É (–µ–µ –æ–±—Å—É–∂–¥–∞–ª–∏ –Ω–∞ –≤–æ–æ–¥–Ω–æ–º –∑–∞–Ω—è—Ç–∏–∏). –°–º—ã—Å–ª –±—ã–ª –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –≤—ã–≥—Ä—É–∑–∫—É –±–æ–ª–µ–µ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–π. –ï—Å–ª–∏ –±—Ä–∞—Ç—å –≤ –¥–æ–ø—É—â–µ–Ω–∏–µ, —á—Ç–æ –µ—Å—Ç—å –∑–∞–∫–∞–∑—ã —Å –ø–æ–∫—É–ø–∫–æ–π —Å—Ä–∞–∑—É 2-3—Ö —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Ü–µ–Ω–µ 14–∫ - —Ç–æ–≥–¥–∞ –Ω–µ —É–±–∏—Ä–∞—Ç—å –Ω–∏—á–µ–≥–æ. –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ç–∞–∫–∏–µ –∑–∞–∫–∞–∑—ã –±—ã–≤–∞—é—Ç. –†–æ–≤–Ω–æ –∫–∞–∫ –∏ –∑–∞–∫–∞–∑—ã –∏–∑ 1000 –≤–∞–Ω—Ç—É–∑–æ–≤, –æ–¥–Ω–∞–∫–æ –∏—Ö –º—ã –æ–±—Ä–µ–∑–∞–µ–º, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø—Ä–æ—Ä–∞–±–∞—Ç—ã–≤–∞–ª–æ—Å—å –≤ –ø—Ä–µ–∂–Ω–∏–∂ –ø—Ä–æ–µ–∫—Ç–∞—Ö. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –≤ –æ–±—É—á–µ–Ω–∏–∏ –±—ã–ª–∞ —á–∞—Å—Ç—å –ø—Ä–æ –æ–±—Ä–µ–∑–∞–Ω–∏–µ –ø–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—é. –Ø –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É—é —ç—Ç—É —á–∞—Å—Ç—å –∏ –Ω–µ –±—É–¥—É –Ω–∞ —á–µ—Ç–≤–µ—Ä—Ç–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –Ω–∏—á–µ–≥–æ –æ–±—Ä–µ–∑–∞—Ç—å –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ. –ù–∞–ø–∏—à–∏, –µ—Å–ª–∏ –º—ã –æ—Å—Ç–∞–≤–ª—è–µ–º —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö
# </div>
# <div class="alert alert-success">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ v.5</b>
#     
#   ‚úîÔ∏è 1000 –≤–∞–Ω—Ç—É–∑–æ–≤ –≤ –∫–∞–∫–æ–º-—Ç–æ –Ω–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ (–Ω–∞—à –º–∞–Ω–∞–∑–∏–Ω –Ω–µ –ø–æ—Ö–æ–∂ –Ω–∞ –º–∞–≥–∞–∑–∏–Ω —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∏), –Ω–µ –¥—É–º–∞—é, —á—Ç–æ –æ–Ω–∏ –¥–∞–∂–µ –≤ –Ω–∞–ª–∏—á–∏–∏ –±—ã–ª–∏. –¢—É—Ç —è–≤–Ω–æ –æ—à–∏–±–∫–∞ - –¥–æ–±–∞–≤–∏–ª–∏ –ª–∏—à–Ω–∏–µ 0. –û—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–∫–∞–∑—ã –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ç–æ–≤–∞—Ä–æ–≤ –∏ —á–µ–∫—É –ø–æ—Ö–æ–∂–∏ –Ω–∞ –ø—Ä–∞–≤–¥—É –∏ –º—ã –∏—Ö –Ω–µ –æ–±—Ä–µ–∑–∞–µ–º.
# </div>
# <div class="alert alert-warning">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ v.5</b>
#     
#   ‚ö†Ô∏è –ê –≤–æ—Ç –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–∫–∞–∑–æ–≤ —É –Ω–∞—Å –æ–¥–∏–Ω –∫–ª–∏–µ–Ω—Ç —Å–æ 126 –∑–∞–∫–∞–∑–∞–º–∏ —Å–∏–ª—å–Ω–æ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è (—Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –º—ã –ø–æ–ª—É—á–∞–µ–º –∫–ª–∞—Å—Ç–µ—Ä –∏–∑ –æ–¥–Ω–æ–≥–æ —ç—Ç–æ–≥–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è), —ç—Ç–æ –ø–æ—Ä—è–¥–æ–∫ –±–æ–ª—å—à–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö. –í–æ–∑–º–æ–∂–Ω–æ, –∏–∑-–∑–∞ —ç—Ç–æ–≥–æ –∑–∞–∫–∞–∑–∞ –Ω–∏–∂–µ —É –Ω–∞—Å –¥–µ–Ω–¥–æ–≥—Ä–∞–º–º–∞ –Ω–µ –ø–æ–º–µ—Å—Ç–∏–ª–∞—Å—å —Ü–µ–ª–∏–∫–æ–º (—É—Ö–æ–¥–∏—Ç –≤ –ª–µ–≤–æ) –∏ –º—ã –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ —Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.  KMeans –æ—á–µ–Ω—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –≤—ã–±—Ä–æ—Å–∞–º. 
#     
# –ò —è –±—ã –µ—â–µ —É–±—Ä–∞–ª –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π `average_unique_categories`, —É –Ω–∞—Å 97% –ø–æ–∫—É–ø–æ–∫ —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –Ω–∞–º —ç—Ç–æ –Ω–∏—á–µ–≥–æ —Å–æ–±–æ –Ω–µ –ø–æ–∫–∞–∂–µ—Ç, –∞ –≤–æ—Ç –∏—Å–∫–∞–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ KMeans –º–æ–∂–µ—Ç.
#     
# –ü–æ–ø—Ä–æ–±–æ–≤–∞–ª –æ–±—Ä–µ–∑–∞—Ç—å –≤—ã–±—Ä–æ—Å –ø–æ –∑–∞–∫–∞–∑–∞–º –∏ —É–±—Ä–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –ø–æ–ª—É—á–∞–µ—Ç—Å—è 3 –∫–ª–∞—Å—Ç–µ—Ä–∞.
# </div>

# In[34]:


# –ø–æ—Å—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞ –∑–∞–∫–∞–∑
df_cat = df.groupby(by=['customer_id', 'order_id']).agg(unique_categories=('category', 'nunique')).reset_index()
df = df.merge(df_cat, how='inner', on=['customer_id', 'order_id'])


# In[35]:


customer_segments = df.groupby('customer_id').agg(
    average_price=('price', 'mean'),  # –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞
    average_quantity=('quantity', 'mean'),  # –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ
    average_total=('total_price', 'mean'),  # –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–æ –∑–∞–∫–∞–∑—É
    average_unique_categories=('unique_categories', 'mean'),  # –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤
    orders_cnt=('order_id', 'nunique') # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è
).reset_index()


# <div class="alert alert-danger">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
#     
#   ‚ùå –í –∞–Ω–∞–ª–∏–∑–µ —É –Ω–∞—Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–∞–∂–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä (–≤ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –µ–≥–æ –Ω–∞–∑—ã–≤–∞–ª–∏) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è. –¢–æ–ª—å–∫–æ —Ç–∞–∫ –º—ã –≤—ã—è–≤–∏–º –ª–æ—è–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
# </div>

# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
#     
#   –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –¥–æ–±–∞–≤–∏–ª–∏
# </div>
# <div class="alert alert-success">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ v.2</b>
#     
#   ‚úîÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤—ã–±—Ä–∞–ª–∏ –≤–µ—Ä–Ω–æ.
#  
# </div>

# In[36]:


# –∏—Å—Å–ª–µ–¥—É–µ–º –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –º–µ—Ç–æ–¥–æ–º –ª–æ–∫—Ç—è
sse = []
k_values = range(1, 11)

for k in k_values:
    kmeans = KMeans(n_clusters=k, random_state=42)
    kmeans.fit(customer_segments[['average_price', 'average_quantity', 'average_total', 'average_unique_categories', 'orders_cnt']])
    sse.append(kmeans.inertia_)

plt.plot(k_values, sse)
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (k)')
plt.ylabel('–°—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –æ—à–∏–±–æ–∫ (SSE)')
plt.title('–ú–µ—Ç–æ–¥ –ª–æ–∫—Ç—è')
plt.show()


# In[37]:


# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è , —Å–∫–æ–ª—å–∫–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –≤—ã–¥–µ–ª–∏—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ
linked = sch.linkage(customer_segments[['average_price', 'average_quantity', 'average_total', 'average_unique_categories', 'orders_cnt']], method='ward')

plt.figure(figsize=(10, 7))
dendrogram = sch.dendrogram(linked)
plt.title('–î–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º–∞')
plt.xlabel('–ò–Ω–¥–µ–∫—Å—ã –∫–ª–∏–µ–Ω—Ç–æ–≤')
plt.ylabel('–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ')
plt.show()


# In[38]:


# –í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
features = customer_segments[['average_price', 'average_quantity', 'average_total', 'average_unique_categories', 'orders_cnt']]

# –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
scaler = StandardScaler()
scaled_features = scaler.fit_transform(features)


# In[39]:


# –û–ø—Ä–µ–¥–µ–ª–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
kmeans = KMeans(n_clusters=2, random_state=42) 
customer_segments['cluster'] = kmeans.fit_predict(scaled_features)

customer_segments['cluster'] += 1

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
customer_segments.head()


# <div class="alert alert-danger">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
# 
#   ‚ùå –ú—ã –Ω–µ —Å—Ç—Ä–æ–∏–ª–∏ –¥–µ–Ω–¥–æ–≥—Ä–∞–º–º—É, –Ω–µ –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ –º–µ—Ç–æ–¥–æ–º –ª–æ–∫—Ç—è, –æ—Ç–∫—É–¥–∞ —É –Ω–∞—Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–ª–∞—Å—Ç–µ—Ä–æ–≤  —Ä–∞–≤–Ω–æ–µ 4?
# </div>

# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
#     
#   –ü–æ—Å—Ç—Ä–æ–∏–ª–∏ –æ–±–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏, –≤—Å–µ —É–∫–∞–∑–∞–ª–∏ –Ω–∞ 3 –∫–ª–∞—Å—Ç–µ—Ä–∞. –ú–æ–¥–µ–ª—å —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–ª–∏
# </div>
# <div class="alert alert-danger">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ v.2</b>
# 
#   ‚ùå –ü–æ –¥–µ–Ω–¥–æ–≥—Ä–∞–º–º–µ —É –Ω–∞—Å —Ü–≤–µ—Ç–æ–º –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –≤—Å–µ–≥–æ 2 –∫–ª–∞—Å—Ç–µ—Ä–∞: –æ—Ä–∞–Ω–∂–µ–≤—ã–π –∏ –∑–µ–ª–µ–Ω—ã–π, –Ω–æ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∞ –æ–±—Ä–µ–∑–∫–∏ –≤—ã–±—Ä–æ—Å–æ–≤, –º—ã –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö –≤—ã–∫–∏–Ω—É–ª–∏.
# </div>

# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞ 2</b>
#     
#   –ü–æ—Å–ª–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º–∞ –≤—Å–µ –µ—â–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 2 –∫–ª–∞—Å—Ç–µ—Ä–∞. –ü—Ä–æ–≤–µ–ª–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ 2–º
# </div>
# 
#  <div class="alert alert-warning">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ v.3</b>
#     
#   ‚ö†Ô∏è –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –Ω–µ –∑–∞–±—ã—Ç—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å.
#     
# </div>
# 

#  <div class="alert alert-warning">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
#     
#   ‚ö†Ô∏è –°—Ç–æ–∏—Ç –æ–ø–∏—Å–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã, –ø–æ —Å—Ä–µ–¥–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏—è–º, –Ω–∞–ø—Ä–∏–º–µ—Ä. –°–µ–π—á–∞—Å –Ω–µ –æ—á–µ–Ω—å –≤–∏–¥–Ω–∞ –Ω–∞—à–∞ —Ä–∞–±–æ—Ç–∞.
#     
# </div>

# In[40]:


customer_segments_cut = customer_segments[['customer_id', 'cluster']].drop_duplicates()
df = df.merge(customer_segments_cut, how='inner', on='customer_id')


# In[41]:


# –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç–æ–≤–∞—Ä–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
category_analysis = df.groupby(['cluster', 'category']).agg(total_sales=('total_price', 'sum'), 
                                                            orders=('order_id', 'nunique'),
                                                           total_quantity=('quantity', 'sum')).reset_index()
category_analysis['total_sales'] = category_analysis['total_sales'] / 1000000
category_analysis['orders'] = category_analysis['orders'] / 1000
category_analysis['total_quantity'] = category_analysis['total_quantity'] / 1000

# –°–æ–∑–¥–∞–µ–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
pivot_table = category_analysis.pivot(index='category', columns='cluster', values='total_sales').fillna(0)

# –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
plt.figure(figsize=(12, 6))
sns.heatmap(pivot_table, annot=True, cmap='GnBu')
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∂ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ (–º–ª–Ω.)')
plt.xlabel('–ö–ª–∞—Å—Ç–µ—Ä')
plt.ylabel('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')
plt.show()

# –°–æ–∑–¥–∞–µ–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
pivot_table = category_analysis.pivot(index='category', columns='cluster', values='orders').fillna(0)

# –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
plt.figure(figsize=(12, 6))
sns.heatmap(pivot_table, annot=True, cmap='GnBu')
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ (—Ç—ã—Å.)')
plt.xlabel('–ö–ª–∞—Å—Ç–µ—Ä')
plt.ylabel('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')
plt.show()

# –°–æ–∑–¥–∞–µ–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
pivot_table = category_analysis.pivot(index='category', columns='cluster', values='total_quantity').fillna(0)

# –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
plt.figure(figsize=(12, 6))
sns.heatmap(pivot_table, annot=True, cmap='GnBu')
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ (—Ç—ã—Å.)')
plt.xlabel('–ö–ª–∞—Å—Ç–µ—Ä')
plt.ylabel('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')
plt.show()


# **–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥**
# 
# –ò—Ç–∞–∫, –±—ã–ª–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–æ 2 —Ö–∏—Ç–º—ç–ø–∞ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º –∏ —Ç–æ–≤–∞—Ä–Ω—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º, –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–∫–∞–∑–æ–≤ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤. –í–∏–¥–∏–º, —á—Ç–æ:
# 
# 1. –ö–ª–∞—Å—Ç–µ—Ä 1 - —ç—Ç–æ –≥—Ä—É–ø–ø–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ –±–æ–ª–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ, –Ω–æ –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –≤ —ç—Ç–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ –Ω–∞–±–ª—é–¥–∞—é—Ç—Å—è –Ω–∏–∑–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–∫–∞–∑–æ–≤ –∏ –æ–±—â–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ç–æ–≤–∞—Ä–æ–≤, –∫–ª–∏–µ–Ω—Ç—ã –ø—Ä–æ—è–≤–ª—è—é—Ç —è–≤–Ω–æ–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ –∫ —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–µ –∏ –º–µ–±–µ–ª–∏. –≠—Ç–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–∞–∏–≤—ã—Å—à–∏–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤. –î—Ä—É–≥–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –¥–µ–∫–æ—Ä –∏ —Ö–æ–∑—Ç–æ–≤–∞—Ä—ã, –∏–º–µ—é—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –≤ —Ä–∞–º–∫–∞—Ö —ç—Ç–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ –∫–ª–∏–µ–Ω—Ç—ã –∑–¥–µ—Å—å –¥–µ–ª–∞—é—Ç –∞–∫—Ü–µ–Ω—Ç –Ω–∞ –∫—Ä—É–ø–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏, –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã.
# 
# 2. –ö–ª–∞—Å—Ç–µ—Ä 2 - —Å–∞–º—ã–π –º–∞—Å—Å–∏–≤–Ω—ã–π –ø–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º. –í —ç—Ç–æ—Ç –∫–ª–∞—Å—Ç–µ—Ä —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏–ª–∏—Å—å –∫–ª–∏–µ–Ω—Ç—ã, –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—â–∏–µ –ø–æ–∫—É–ø–∞—Ç—å —Ä–∞—Å—Å–∞–¥—É, —Ä–∞—Å—Ç–µ–Ω–∏—è –∏ —Ü–≤–µ—Ç—ã, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è –≤—ã—Å–æ–∫–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–æ –≤—Å–µ–º —Ç—Ä–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º. –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –∫–ª–∏–µ–Ω—Ç—ã —ç—Ç–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç—Å—è —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–æ–π –∏ —Ö–æ–∑—Ç–æ–≤–∞—Ä–∞–º–∏, –æ–¥–Ω–∞–∫–æ –∏—Ö –ø–æ–∫—É–ø–∫–∏ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–µ–∫–æ—Ä–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∂–µ. –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ç–æ–≤–∞—Ä–æ–≤ –∏ –∑–∞–∫–∞–∑–æ–≤ –≤—ã–¥–µ–ª—è—é—Ç—Å—è —Å—Ä–µ–¥–∏ –ø—Ä–æ—á–∏—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ –∫ –ø–æ–∫—É–ø–∫–∞–º –≤ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –Ω–∏–∑–∫–æ—Å—Ç–æ—è—â–∏—Ö —Ç–æ–≤–∞—Ä–∞—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ö–æ–∑—Ç–æ–≤–∞—Ä—ã –∏ —Ä–∞—Å—Å–∞–¥–∞. –í —Ç–æ –∂–µ –≤—Ä–µ–º—è, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –≤—ã—Å–æ–∫–∏–µ –æ–±—ä–µ–º—ã –ø—Ä–æ–¥–∞–∂, –∫–ª–∏–µ–Ω—Ç—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç –±–æ–ª–µ–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–µ–∫–æ—Ä–∞. –ö–∞—Å–∞—Ç–µ–ª—å–Ω–æ —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∏ –∏ –º–µ–±–µ–ª–∏, —Ö–æ—Ç—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∏ —è–≤–ª—è–µ—Ç—Å—è –±–æ–ª–µ–µ –¥–æ—Ä–æ–≥–æ–π, —É—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–¥–∞–∂ –æ—Å—Ç–∞–µ—Ç—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º –±–ª–∞–≥–æ–¥–∞—Ä—è —Å—Ä–µ–¥–Ω–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–∫–∞–∑–æ–≤ –∏ —Ç–æ–≤–∞—Ä–∞–º –≤ –∫–∞–∂–¥–æ–º –∑–∞–∫–∞–∑–µ.

# In[42]:


# –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º, –∫–ª–∞—Å—Ç–µ—Ä–∞–º –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º 
seasonal_trends = df.groupby(['month', 'cluster', 'category']).agg(total_sales=('total_price', 'sum')).reset_index()

# –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –º–µ—Å—è—Ü –≤ —Å—Ç—Ä–æ–∫–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
seasonal_trends['month'] = seasonal_trends['month'].astype(str)

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –≥—Ä–∞—Ñ–∏–∫–∞
plt.figure(figsize=(14, 7))

# –°–æ–∑–¥–∞–µ–º —Å—Ç–æ–ª–±—á–∞—Ç—É—é –¥–∏–∞–≥—Ä–∞–º–º—É —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞
sns.barplot(data=seasonal_trends, x='month', y='total_sales', hue='cluster', ci=None)

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –º–µ—Ç–∫–∏
plt.title('–°–µ–∑–æ–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã –ø—Ä–æ–¥–∞–∂ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º')
plt.xlabel('–ú–µ—Å—è—Ü')
plt.ylabel('–û–±—â–∏–µ –ø—Ä–æ–¥–∞–∂–∏')
plt.xticks(rotation=35)  # –ü–æ–≤–æ—Ä–æ—Ç –ø–æ–¥–ø–∏—Å–µ–π –Ω–∞ 45 –≥—Ä–∞–¥—É—Å–æ–≤
plt.legend(title="–ö–ª–∞—Å—Ç–µ—Ä—ã", loc='upper right')
plt.grid(axis='y')  # –í–∫–ª—é—á–∞–µ–º —Å–µ—Ç–∫—É —Ç–æ–ª—å–∫–æ –ø–æ –æ—Å–∏ Y –¥–ª—è –ª—É—á—à–µ–π –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥—Ä–∞—Ñ–∏–∫
plt.tight_layout()  # –£–º–µ–Ω—å—à–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã –¥–ª—è –ª—É—á—à–µ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
plt.show()


# In[43]:


# –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º, –∫–ª–∞—Å—Ç–µ—Ä–∞–º –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
seasonal_trends = df.groupby(['month', 'cluster', 'category']).agg(total_sales=('total_price', 'sum')).reset_index()

# –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –º–µ—Å—è—Ü –≤ —Å—Ç—Ä–æ–∫–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
seasonal_trends['month'] = seasonal_trends['month'].astype(str)

# –ü–æ–ª—É—á–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
clusters = seasonal_trends['cluster'].unique()

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –≥—Ä–∞—Ñ–∏–∫–æ–≤
plt.figure(figsize=(14, 7 * len(clusters)))

# –°–æ–∑–¥–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞
for i, cluster in enumerate(clusters):
    plt.subplot(len(clusters), 1, i + 1)  # –°–æ–∑–¥–∞–µ–º –ø–æ–¥–≥—Ä–∞—Ñ–∏–∫ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞
    cluster_data = seasonal_trends[seasonal_trends['cluster'] == cluster]  # –§–∏–ª—å—Ç—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä—É
    
    sns.barplot(data=cluster_data, x='month', y='total_sales', hue='category', ci=None)
    
    plt.title(f'–°–µ–∑–æ–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã –ø—Ä–æ–¥–∞–∂ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∞: {cluster}')
    plt.xlabel('–ú–µ—Å—è—Ü')
    plt.ylabel('–û–±—â–∏–µ –ø—Ä–æ–¥–∞–∂–∏')
    plt.xticks(rotation=45)  # –ü–æ–≤–æ—Ä–æ—Ç –ø–æ–¥–ø–∏—Å–µ–π –Ω–∞ 45 –≥—Ä–∞–¥—É—Å–æ–≤
    plt.legend(title="–ö–∞—Ç–µ–≥–æ—Ä–∏–∏", bbox_to_anchor=(1.05, 1), loc='upper left')  # –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –ª–µ–≥–µ–Ω–¥—ã
    plt.grid(axis='y')  # –í–∫–ª—é—á–∞–µ–º —Å–µ—Ç–∫—É —Ç–æ–ª—å–∫–æ –ø–æ –æ—Å–∏ Y –¥–ª—è –ª—É—á—à–µ–π –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏

plt.tight_layout()  # –£–º–µ–Ω—å—à–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã –¥–ª—è –ª—É—á—à–µ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
plt.show()


# <div class="alert alert-warning">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
#     
#   ‚ö†Ô∏è –í—Ä–µ–º–µ–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –ª—É—á—à–µ —Å—Ç—Ä–æ–∏—Ç—å –ª–∏–Ω–µ–π–Ω—ã–º–∏, —Ç–∞–∫ –æ–Ω–∏ –ø–æ–Ω—è—Ç–Ω–µ–π.
# </div>

# **–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥**
# 
# –ú—ã –ø–æ—Å—Ç—Ä–æ–∏–ª–∏ –¥–∏–∞–≥—Ä–∞–º–º—É –ø–æ –º–µ—Å—è—Ü–∞–º, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–µ–∑–æ–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã –ø—Ä–æ–¥–∞–∂ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º. –ò—Ç–∞–∫:
# 
# 1. –ö–ª–∞—Å—Ç–µ—Ä 1: –ó–∞–º–µ—Ç–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ –Ω–∞ –ö–ì–¢ –ø—Ä–æ–¥—É–∫—Ü–∏—é. —Ö–æ—Ç—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø–æ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–∏–ª—å–Ω–æ –≤–∞—Ä—å–∏—Ä—É—é—Ç—Å—è –æ—Ç –º–µ—Å—è—Ü–∞ –∫ –º–µ—Å—è—Ü—É. –ú–æ–∂–Ω–æ –≥–æ–≤–æ—Ä–∏—Ç—å –æ —Ç–∞–∫–æ–π –∂–µ –≤–æ–ª–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–π, –Ω–æ —Ç–µ–º –Ω–µ –º–µ–Ω–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–∫—É–ø–æ–∫ –ø–æ —Ö–æ–∑—Ç–æ–≤–∞—Ä–∞–º. –ó–∞–º–µ—Ç–Ω–∞ –∫—Ä–∞–π–Ω—è—è –Ω–µ–∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Å–µ–≥–º–µ–Ω—Ç–∞ –≤ –ø–æ–∫—É–ø–∫–µ —Ä–∞—Å—Å–∞–¥—ã, —á—É—Ç—å –±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ—Å—É–¥—ã (–æ–¥–Ω–∞–∫–æ –≤—ã–¥–µ–ª–∏–ª–∞—Å—å –æ–Ω–∞ –∑–∞ —Å—á–µ—Ç –≤—Å–ø–ª–µ—Å–∫–∞ –ø—Ä–æ–¥–∞–∂ –≤ —Å–µ–Ω—Ç—è–±—Ä–µ 2019 –≥–æ–¥–∞. –ò–Ω—Ç–µ—Ä–µ—Å –∫ –¥–µ–∫–æ—Ä—É –º–æ–∂–Ω–æ –Ω–∞–∑–≤–∞—Ç—å —Å—Ä–µ–¥–Ω–∏–º, –ø—Ä–æ—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è —è–≤–Ω–∞—è —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å —Å–ø—Ä–æ—Å–∞, –∫–æ—Ç—Ä–∞—è –≤—ã–∑–≤–∞–Ω–∞ –Ω–∞–ª–∏—á–∏–µ–º –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤. –ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–æ—à–ª—ã–º –≥–æ–¥–æ–º, –≤ 2019 –≥–æ–¥—É –≤ –¥–µ–∫–∞–±—Ä–µ –ø—Ä–æ–¥–∞–∂–∏ —É–ø–∞–ª–∏ –ø–æ—á—Ç–∏ –≤ 3 —Ä–∞–∑–∞
# 
# 2. –ö–ª–∞—Å—Ç–µ—Ä 2: –ü—Ä–∏ —Ç–æ–º, —á—Ç–æ —ç—Ç–æ—Ç –∫–ª–∞—Å—Ç–µ—Ä —è–≤–ª—è–µ—Ç—Å—è –ª–∏–¥–µ—Ä–æ–º —Å—Ä–µ–¥–∏ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º, –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ä–µ–∑–∫–æ —É–ø–∞–ª–∏ –≤ –∏—é–Ω–µ 2019 –≥–æ–¥–∞. –†–∞—Å—Å–º–æ—Ç—Ä–µ–≤ –¥–µ—Ç–∞–ª—å–Ω—É—é —Ä–∞–∑–±–∏–≤–∫—É –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º, –º—ã –≤–∏–¥–∏–º —è–≤–Ω—É—é —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ –Ω–∏—Ö: –∫–∞–∫ –∏ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–ª–æ—Å—å, —Å–µ–º–µ–Ω–∞ –∏ —Ä–∞—Å—Ç–µ–Ω–∏—è –∑–∞–∫—É–ø–∞—é—Ç—Å—è –≤ –±–æ–ª—å—à–æ–º –æ–±—ä–µ–º–µ –∏–º–µ–Ω–Ω–æ –≤ –ø–µ—Ä–∏–æ–¥ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ—Å–µ–≤–æ–≤ –≤–µ—Å–Ω–æ–π, –∞ –ª–µ—Ç–æ–º –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Å–ø–∞–¥. –í —Ç–æ –∂–µ –≤—Ä–µ–º—è –ª–µ—Ç–æ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–µ, –º–µ–±–µ–ª–∏ –∏ –ø—Ä–æ—á–∏–º –ö–ì–¢ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–æ–¥–Ω–∏–º–∞—Ç—å—Å—è, –Ω–æ –µ—ë –≤–µ–ª–∏—á–∏–Ω–∞ —É–∂–µ –Ω–µ —Ç–∞–∫–∞—è –≤—ã—Å–æ–∫–∞—è, –∫–∞–∫ –≥–æ–¥ –Ω–∞–∑–∞–¥. –ü–æ—Å—É–¥–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ –¥–µ—Ä–∂–∞–ª–∞—Å—å –Ω–∞ –Ω–∏–∑–∫–æ–º —É—Ä–æ–≤–Ω–µ –≤–µ—Å—å –ø–µ—Ä–∏–æ–¥ —Å –∏—é–Ω—è (–ø—Ä–∏ —Ç–æ–º, —á—Ç–æ —Ä–∞–Ω–µ–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –±—ã–ª–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–µ), –∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞—á–∞–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –∫ 2020 –≥–æ–¥—É. –ó–∞–º–µ—Ç–Ω–æ, —á—Ç–æ –ø–∞–¥–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∂ –ø—Ä–æ–∏–∑–æ—à–ª–æ –ø–æ –≤—Å–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º, –∏ –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ —É—Ö—É–¥—à–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–æ –≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Äî –≤ –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ–º —É—Ä–æ–≤–Ω–µ –±—ã–ª–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ —É—Ö—É–¥—à–µ–Ω–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è. –í–∞–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —ç—Ç–æ—Ç —Å–µ–≥–º–µ–Ω—Ç –∏ –ø—Ä–æ–¥—É–º–∞—Ç—å —Å–ø–æ—Å–æ–±—ã –ø–æ–≤—ã—à–µ–Ω–∏—è –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤

# **–ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥**
# 
# –í —Ö–æ–¥–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –±—ã–ª–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ —á–µ—Ç—ã—Ä–µ –∫–ª–∞—Å—Ç–µ—Ä–∞, –æ—Ç—Ä–∞–∂–∞—é—â–∞—è –∏—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ. –î–ª—è —ç—Ç–æ–≥–æ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã, –∞ –∏–º–µ–Ω–Ω–æ: 
# 
# - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª–∏–µ–Ω—Ç—É, —Å —Ä–∞—Å—Å—á–µ—Ç–æ–º —á–µ—Ç—ã—Ä–µ—Ö –º–µ—Ç—Ä–∏–∫: —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–æ–∫, —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ, —Å—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —á–µ–∫–∞ –∏ —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –æ–±–æ–±—â–µ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
# - –ø—Ä–æ–≤–µ–¥–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–≤: –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç–æ–¥–æ–º "–ª–æ–∫—Ç—è" –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º—ã. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±–æ–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ —É–∫–∞–∑–∞–ª–∏ –Ω–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ—Å—Ç—å –¥–µ–ª–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –Ω–∞ 2 —Å–µ–≥–º–µ–Ω—Ç–∞.
# - –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å –ø–æ–º–æ—â—å—é StandartScaler. –≠—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –≤–ª–∏—è–Ω–∏—è —Ä–∞–∑–ª–∏—á–∏–π –≤ –º–∞—Å—à—Ç–∞–±–∞—Ö –≤–µ–ª–∏—á–∏–Ω, —Ç–∞–∫ –∫–∞–∫ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é —à–∫–∞–ª—ã
# 
# *–°–∞–º–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –Ω–∞ –º–æ–¥–µ–ª–∏ K-Means.*
# 
# –ù–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–µ—Ö —Ö–∏—Ç–º—ç–ø–æ–≤ –∏ —Å–µ–∑–æ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–¥–∞–∂ –±—ã–ª–∏ —Å–¥–µ–ª–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–≤–æ–¥—ã:
# 
# 1. –ö–ª–∞—Å—Ç–µ—Ä 1 –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –≤ –ö–ì–¢, —Ö–æ—Ç—è –∫–æ–ª–µ–±–∞–Ω–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã. –°–µ–≥–º–µ–Ω—Ç —Ö–æ–∑—Ç–æ–≤–∞—Ä–æ–≤ —Ç–∞–∫–∂–µ –æ—Å—Ç–∞–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º - –ø—Ä–æ–¥–∞–∂–∏ –∏–º–µ—é—Ç—Å—è –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–≥–æ –≥–æ–¥–∞, –Ω–æ –∏ –æ–Ω–∏ —Å–µ–∑–æ–Ω–Ω—ã - –≤ –º–∞–µ –∏ –∏—é–Ω–µ –≤–∏–¥–Ω–æ, –∫–∞–∫ –æ–Ω–∏ –ø—Ä–æ—Å–µ–ª–∏. –°–ø—Ä–æ—Å –Ω–∞ —Ä–∞—Å—Å–∞–¥—É –Ω–∏–∑–∫–∏–π, –∫–∞–∫ –∏ –ø–æ—Å—É–¥—ã, –æ–¥–Ω–∞–∫–æ –ø–æ –Ω–µ–π –ø—Ä–æ–¥–∞–∂–∏ –≤—ã—à–ª–∏ –Ω–∞ –ø–∏–∫ –≤ —Å–µ–Ω—Ç—è–±—Ä–µ 2019 –≥–æ–¥–∞, –ø–æ—Å–ª–µ —á–µ–≥–æ —Å–Ω–æ–≤–∞ –ø—Ä–µ–∫—Ä–∞—Ç–∏–ª–∏—Å—å. –°–µ–≥–º–µ–Ω—Ç –¥–µ–∫–æ—Ä–∞ –ø—Ä–æ–¥–∞–µ—Ç—Å—è –Ω–∞ —Å—Ä–µ–¥–Ω–µ–º —É—Ä–æ–≤–Ω–µ, —Å–ø—Ä–æ—Å –Ω–∞ –Ω–µ–≥–æ –≤ –ø—Ä–∞–∑–Ω–∏—á–Ω—ã–µ –º–µ—Å—è—Ü—ã, –Ω–æ —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è —Å–Ω–∏–∂–∞–µ—Ç—Å—è - –ø–æ—á—Ç–∏ –≤ 3 —Ä–∞–∑–∞ —É–ø–∞–ª–∏ –ø—Ä–æ–¥–∞–∂–∏ , –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –¥–µ–∫–∞–±—Ä–µ–º –≥–æ–¥ –Ω–∞–∑–∞–¥.
# 
# 2. –í –ö–ª–∞—Å—Ç–µ—Ä–µ 2 –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Ä–µ–∑–∫–æ–µ –ø–∞–¥–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∂ –≤ –∏—é–Ω–µ 2019 –≥–æ–¥–∞, —Å –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ–π —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å—é. –í–µ—Å–Ω–æ–π –≤—ã—Å–æ–∫–∏–µ –æ–±—ä–µ–º—ã –ø—Ä–æ–¥–∞–∂ —Å–µ–º—è–Ω –∏ —Ä–∞—Å—Ç–µ–Ω–∏–π —Å–º–µ–Ω—è—é—Ç—Å—è –ª–µ—Ç–Ω–∏–º —Å–ø–∞–¥–æ–º, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞, –º–µ–±–µ–ª—å –∏ –ö–ì–¢ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–µ–≤—ã—Å–æ–∫–∏–π, –Ω–æ —Ä–∞—Å—Ç—É—â–∏–π —Å–ø—Ä–æ—Å. –ü—Ä–æ–¥–∞–∂–∏ –ø–æ—Å—É–¥—ã –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ –Ω–∏–∑–∫–æ–º —É—Ä–æ–≤–Ω–µ –¥–æ 2020 –≥–æ–¥–∞.   
# 
# 3. –í–∞–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–Ω–∏–∂–µ–Ω–∏–µ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–µ—Å–∞ –∫ –ø—Ä–æ–¥—É–∫—Ç–∞–º. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞—é—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–º –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º, –∞ —Ç–∞–∫–∂–µ –≤–ª–∏—è–Ω–∏–µ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏ –∏ –≤–Ω–µ—à–Ω–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –Ω–∞ –ø—Ä–æ–¥–∞–∂–∏. –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞ –∏ –ø–æ–≤—ã—à–µ–Ω–∏—è –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –∫–∞–∂–¥–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ.
# 
# –ü—Ä–æ–≤–µ—Ä–∏–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –ø–æ–º–æ—â–∏ 3—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≥–∏–ø–æ—Ç–µ–∑.

# <div class="alert alert-danger">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
#  
#     
#   ‚ùå –ù–∞–º –µ—â–µ –≤–∞–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –∏–∑ –ø–æ–ª—É—á–∏–≤—à–∏—Ö—Å—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.  –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø—Ä–æ–≤–µ—Å—Ç–∏ –±–æ–ª–µ–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞—Å—Å—ã–ª–∫–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –∞ —Ç–∞–∫–∂–µ –ø–æ–≤—ã—Å–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤.
# 
# </div>

# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
#     
#   –ì—Ä–∞—Ñ–∏–∫–∏ –¥–æ–±–∞–≤–∏–ª–∏, –≤—ã–≤–æ–¥—ã —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–ª–∏
# </div>
# <div class="alert alert-success">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ v.2</b>
#     
#   ‚úîÔ∏è –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏.
# 
#     
# </div>

# ### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑

# - –ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ (H0): –ï—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π
# - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ (H1): –ù–µ—Ç —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π

# <div class="alert alert-success">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
#     
#   ‚úîÔ∏è –ù—É–ª–µ–≤–∞—è –∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑—ã —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω—ã. 
# 
#     
# </div>

# In[44]:


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
for cluster in customer_segments['cluster'].unique():
    data = customer_segments[customer_segments['cluster'] == cluster]['average_total']
    shapiro_stat, shapiro_p = stats.shapiro(data)
    print(f'–ö–ª–∞—Å—Ç–µ—Ä {cluster}: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞ = {shapiro_stat}, p-–∑–Ω–∞—á–µ–Ω–∏–µ = {shapiro_p}')
    if shapiro_p < 0.05:
        print("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ average_total –Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.")
    else:
        print("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ average_total –Ω–æ—Ä–º–∞–ª—å–Ω–æ.")

print()     
        
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–ª—è average_total
for cluster in customer_segments['cluster'].unique():
    data = customer_segments[customer_segments['cluster'] == cluster]['average_price']
    shapiro_stat, shapiro_p = stats.shapiro(data)
    print(f'–ö–ª–∞—Å—Ç–µ—Ä {cluster}: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞ = {shapiro_stat}, p-–∑–Ω–∞—á–µ–Ω–∏–µ = {shapiro_p}')
    if shapiro_p < 0.05:
        print("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ average_price –Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.")
    else:
        print("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ average_price –Ω–æ—Ä–º–∞–ª—å–Ω–æ.")
        
print()      

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–ª—è average_total
for cluster in customer_segments['cluster'].unique():
    data = customer_segments[customer_segments['cluster'] == cluster]['average_quantity']
    shapiro_stat, shapiro_p = stats.shapiro(data)
    print(f'–ö–ª–∞—Å—Ç–µ—Ä {cluster}: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞ = {shapiro_stat}, p-–∑–Ω–∞—á–µ–Ω–∏–µ = {shapiro_p}')
    if shapiro_p < 0.05:
        print("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ average_quantity –Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.")
    else:
        print("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ average_quantity –Ω–æ—Ä–º–∞–ª—å–Ω–æ.")


# In[45]:


# –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º —Å—Ç–∞—Ç. –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –ø–æ –º–µ—Ç–æ–¥—É –ë–æ–Ω—Ñ–µ—Ä—Ä–æ–Ω–∏, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è 
alpha = 0.05
n_tests = 4
corrected_alpha = alpha / n_tests
print(f'–°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏: {corrected_alpha}')


# In[46]:


# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏

# –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º
price_groups = customer_segments.groupby('cluster')['average_total'].apply(list)

# –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ Kruskal-Wallis H-—Ç–µ—Å—Ç–∞
kruskal_statistic_price, p_kruskal_price = stats.kruskal(*price_groups)

print(f'Kruskal-Wallis –¥–ª—è average_price: H-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: {kruskal_statistic_price}, p-–∑–Ω–∞—á–µ–Ω–∏–µ: {p_kruskal_price}')

if p_kruskal_price < corrected_alpha:
    print("–û—Ç–≤–µ—Ä–≥–∞–µ–º H0: –ï—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.")
else:
    print("–ù–µ –º–æ–∂–µ–º –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å H0: –ù–µ—Ç —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.")


# In[47]:


clusters = customer_segments['cluster'].unique()

# –°–æ–∑–¥–∞–µ–º DataFrame –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
results = []

# –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø–∞—Ä –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
for i in range(len(clusters)):
    for j in range(i + 1, len(clusters)):
        cluster_1 = customer_segments[customer_segments['cluster'] == clusters[i]]['average_total']
        cluster_2 = customer_segments[customer_segments['cluster'] == clusters[j]]['average_total']
        
        U_statistic, p_value = stats.mannwhitneyu(cluster_1, cluster_2)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Å–ø–∏—Å–æ–∫
        results.append({
            'Cluster i': clusters[i],
            'Cluster j': clusters[j],
            'U Statistic': U_statistic,
            'p-value': p_value
        })

# –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ DataFrame –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
results_df = pd.DataFrame(results)

results_df['Statistical_Significance'] = results_df['p-value'].apply(
    lambda x: '—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å' if x < corrected_alpha else '–Ω–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏'
)

results_df


# <div class="alert alert-danger">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
# 
#   ‚ùå  –ú—ã –Ω–µ –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä —Å –ø–æ–º–æ—â—å—é –∫—Ä–∏—Ç–µ—Ä–∏—è –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞ https://bemind.gitbook.io/neural/v/instrumenty-ocenki/kak-ispolzovat-python-dlya-proverki-normalnosti). –ü—Ä–∏ –Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –∏–ª–∏ –º–∞–ª–µ–Ω—å–∫–æ–º —Ä–∞–∑–º–µ—Ä–µ –≤—ã–±–æ—Ä–æ–∫ –º—ã –Ω–µ –º–æ–∂–µ–º –ø—Ä–∏–º–µ–Ω—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π f_oneway, –ø–æ —Ñ–∞–∫—Ç—É –ø—Ä–æ—Å—Ç–æ –º–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ttest —Å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è.
#     
#     
#   ‚ùå  –û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ç—É—Ç —É –Ω–∞—Å –∏–¥–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑, —É—Ä–æ–≤–µ–Ω—å —Å—Ç–∞—Ç. –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –Ω–∞–¥–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –∏—Å—Ö–æ–¥—è –∏–∑ —ç—Ç–æ–≥–æ.
#   
# –í–æ—Ç —Ç—É—Ç –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å: http://www.machinelearning.ru/wiki/index.php?title=%D0%9C%D0%BD%D0%BE%D0%B6%D0%B5%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D0%B0%D1%8F_%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0_%D0%B3%D0%B8%D0%BF%D0%BE%D1%82%D0%B5%D0%B7
# </div>

# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
#     
# 1. –ü—Ä–∞–≤–¥–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ANOVA –Ω–µ–ª—å–∑—è, –µ—Å–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –ü–æ—Å–∫–æ–ª—å–∫—É –µ—Å—Ç—å —É—Å–ª–æ–≤–∏–µ –Ω–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –º–∏–Ω–∏–º—É–º 2 —Å—Ç–∞—Ç. —Ç–µ—Å—Ç–∞, —Ç–æ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–º–∏–º–æ Kruskal-Wallis —Ç–µ—Å—Ç–∞ –µ—â–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–±–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è. –¢–∞–∫ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —É—Å–ª–æ–≤–∏–µ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é 2—Ö –º–µ—Ç–æ–¥–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏, –∏ —É—á—Ç–µ–Ω–æ —É—Å–ª–æ–≤–∏–µ –ø–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏.
#     
# 2. –ù–∞–≤–µ—Ä—Ö—É —Ç–µ–ø–µ—Ä—å –µ—Å—Ç—å —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –ø–æ –º–µ—Ç–æ–¥—É –ë–æ–Ω—Ñ–µ—Ä—Ä–æ–Ω–∏    
#     
# 3. –í—ã–≤–æ–¥—ã –≤–Ω–∏–∑—É —Ä–∞–∑–¥–µ–ª–∞ –ø–æ –ø—Ä–æ–≤–µ—Ä–∫–µ –≥–∏–ø–æ—Ç–µ–∑ –¥–æ–ø–æ–ª–Ω–µ–Ω—ã - —Ç–µ–ø–µ—Ä—å —Ç–∞–º –Ω–µ —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–æ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –≤—ã–±–æ—Ä–∫–∏
# </div>
# <div class="alert alert-success">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ v.2</b>
#     
#   ‚úîÔ∏è –í–µ—Ä–Ω–æ! –ö—Ä–∏—Ç–µ—Ä–∏–π –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏ –∏–ª–∏ –ö—Ä–∞—Å–∫–µ–ª–∞-–£–æ–ª–ª–∏—Å–∞  –Ω–∞–º —Ç—É—Ç –ø–æ–¥–æ–π–¥–µ—Ç!
#  
# </div>
# <div class="alert alert-warning">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ v.2</b>
#     
#   ‚ö†Ô∏è –ü–æ–ø—Ä–∞–≤–∫–∞ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –≥–∏–ø–æ—Ç–µ–∑ –µ—Å—Ç—å! 
#   
# –û–¥–Ω–∞–∫–æ –ë–æ–Ω—Ñ–µ—Ä—Ä–æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–¥–∫–æ. –≠—Ç–∞ –ø–æ–ø—Ä–∞–≤–∫–∞ —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–æ —É–º–µ–Ω—å—à–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å –∞–ª—å—Ñ–∞, –æ–ø—Ä–æ–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –≤–æ–∑–º–æ–∂–Ω–æ. –õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ —Ç–∞–∫–∏–µ —Å–∏–ª—å–Ω—ã–µ –ø–æ–ø—Ä–∞–≤–∫–∏, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –ø—Ä–∏–º–µ–Ω—è—é—Ç –º–µ—Ç–æ–¥ –•–æ–ª–º–∞, –∏–ª–∏ –º–µ—Ç–æ–¥ –®–∏–¥–∞–∫–∞.
# 
# </div>

# - –ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ (H0): –ï—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–∞–π—Å–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π
# - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ (H1): –ù–µ—Ç —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–∞–π—Å–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π

# In[48]:


# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–∞–π—Å–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏

# –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º
price_groups = customer_segments.groupby('cluster')['average_price'].apply(list)

# –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ Kruskal-Wallis H-—Ç–µ—Å—Ç–∞
kruskal_statistic_price, p_kruskal_price = stats.kruskal(*price_groups)

print(f'Kruskal-Wallis –¥–ª—è average_price: H-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: {kruskal_statistic_price}, p-–∑–Ω–∞—á–µ–Ω–∏–µ: {p_kruskal_price}')

if p_kruskal_price < corrected_alpha:
    print("–û—Ç–≤–µ—Ä–≥–∞–µ–º H0: –ï—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–∞–π—Å–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.")
else:
    print("–ù–µ –º–æ–∂–µ–º –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å H0: –ù–µ—Ç —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–∞–π—Å–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.")


# - –ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ (H0): –ï—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π
# - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ (H1): –ù–µ—Ç —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π

# In[49]:


# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏

# –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º
quantity_groups = customer_segments.groupby('cluster')['average_quantity'].apply(list)

# –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ Kruskal-Wallis H-—Ç–µ—Å—Ç–∞
kruskal_statistic_quantity, p_kruskal_quantity = stats.kruskal(*quantity_groups)

print(f'Kruskal-Wallis –¥–ª—è average_quantity: H-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: {kruskal_statistic_quantity}, p-–∑–Ω–∞—á–µ–Ω–∏–µ: {p_kruskal_quantity}')

if p_kruskal_quantity < corrected_alpha:
    print("–û—Ç–≤–µ—Ä–≥–∞–µ–º H0: –ï—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.")
else:
    print("–ù–µ –º–æ–∂–µ–º –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å H0: –ù–µ—Ç —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.")


# **–ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥**
# 
# –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ–¥–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤ –ø–æ 3–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ:
# 
# - –£–¥–æ—Å—Ç–æ–≤–µ—Ä–∏–ª–∏—Å—å –≤ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é —Ç–µ—Å—Ç–∞ –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞. –î–ª—è —ç—Ç–æ–≥–æ –ø–µ—Ä–µ–¥–∞–ª–∏ –µ–º—É –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ 3—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –ü–æ –∏—Ç–æ–≥—É, –¥–∞–Ω–Ω—ã–µ –æ–∫–∞–∑–∞–ª–∏—Å—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –∞ –∑–Ω–∞—á–∏—Ç , —á—Ç–æ –Ω–µ –≤—Å–µ –º–µ—Ç–æ–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≥–∏–ø–æ—Ç–µ–∑ –Ω–∞–º –¥–æ—Å—Ç—É–ø–Ω—ã. –î–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ç–∞–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –±—ã–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã 2 —Ç–µ—Å—Ç–∞, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ—Å—É–ø–Ω—ã –¥–ª—è –Ω–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:  –ö—Ä–∞—Å–∫–∞–ª–∞-–£–æ–ª–ª–∏—Å–∞ –∏ –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏.
# - –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–ª–∏ —É—Ä–æ–≤–µ–Ω—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏, —Ç–∞–∫ –∫–∞–∫ –º—ã –ø—Ä–æ–≤–æ–¥–∏–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –≥–∏–ø–æ—Ç–µ–∑. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–≤–æ–¥–∏–ª–∞—Å—å —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ –ë–æ–Ω—Ñ–µ—Ä—Ä–æ–Ω–∏, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤ - 4 (3 –ö—Ä–∞—Å–∫–∞–ª–∞ –∏ 1 –ú–∞–Ω–Ω–∞)
# 
# –í —Ö–æ–¥–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–µ—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≥–∏–ø–æ—Ç–µ–∑, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ —Ä–∞–∑–ª–∏—á–∏—è—Ö –≤ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–º –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤, –±—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
# 
# 1. –†–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ: –ü–æ —Ç–µ—Å—Ç—É –ö—Ä–∞—Å–∫–∞–ª–∞-–£–æ–ª–ª–∏—Å–∞: H-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: 526.8745485194556, p-–∑–Ω–∞—á–µ–Ω–∏–µ: 1.3517970787294433e-116. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≥–∏–ø–æ—Ç–µ–∑–∞ H0 (–æ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ —Å—Ä–µ–¥–Ω–∏—Ö —á–µ–∫–æ–≤ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏) –±—ã–ª–∞ –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç–∞. –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã—Ö —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ —Å—Ä–µ–¥–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —ç—Ç–∞ –∂–µ –≥–∏–ø–æ—Ç–µ–∑–∞ –±—ã–ª–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ç–µ—Å—Ç–æ–º –ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ —Ç–æ–∂–µ –ø–æ–∫–∞–∑–∞–ª —Å—Ç–∞—Ç. –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏
# 
# 2. –†–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–∞–π—Å–µ: –î–ª—è —Å—Ä–µ–¥–Ω–∏—Ö —Ü–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Ç–µ—Å—Ç –ö—Ä–∞—Å–∫–∞–ª–∞-–£–æ–ª–ª–∏—Å–∞, –≥–¥–µ H-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: 373.19780677720985, p-–∑–Ω–∞—á–µ–Ω–∏–µ: 3.76652134028398e-83. –° —É—á–µ—Ç–æ–º —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Ç–∞–∫–∂–µ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –≥–∏–ø–æ—Ç–µ–∑–∞ H0, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –Ω–∞–ª–∏—á–∏–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–∞–π—Å–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.
# 
# 3. –†–∞–∑–ª–∏—á–∏—è –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ: –ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Ç—Ä–µ—Ç—å–µ–≥–æ —Ç–µ—Å—Ç–∞ –ö—Ä–∞—Å–∫–∞–ª–∞-–£–æ–ª–ª–∏—Å–∞, H-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: 1.3726416949104818, p-–∑–Ω–∞—á–µ–Ω–∏–µ: 0.24135852205930142. –≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –≥–∏–ø–æ—Ç–µ–∑—ã H0, —á—Ç–æ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É–µ—Ç –æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã—Ö —Ä–∞–∑–ª–∏—á–∏—è—Ö –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤.
# 
# –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç –Ω–∞–ª–∏—á–∏–µ –∑–Ω–∞—á–∏–º—ã—Ö —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ, —Ü–µ–Ω–∞—Ö –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–∞—Ö –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π

# ### –ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥
# 
# –í —Ö–æ–¥–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –±—ã–ª–∏ –≤—ã—è–≤–ª–µ–Ω—ã –≤–∞–∂–Ω—ã–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏ –∏ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏, —á—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞.
# 
# –û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã:
# 
# 1. –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –∑–∞–∫–∞–∑–æ–≤: –ù–∞–∏–±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π –æ–±—ä–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω –≤ –¥–µ–∫–∞–±—Ä–µ –∏ —Ñ–µ–≤—Ä–∞–ª–µ, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ —è–Ω–≤–∞—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–º–µ—Ç–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ. –í–µ—Å–Ω–∞ —Ç–∞–∫–∂–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–µ–∑–æ–Ω–Ω—ã—Ö –∞–∫—Ü–∏–π.
# 
# 2. –í—ã—Ä—É—á–∫–∞ –∏ —Ü–µ–Ω–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è: –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –≤—ã—Å–æ–∫–∏–π –æ–±—ä–µ–º –∑–∞–∫–∞–∑–æ–≤ –≤ –∑–∏–º–Ω–∏–µ –º–µ—Å—è—Ü—ã, –≤—ã—Ä—É—á–∫–∞ –∫–æ–º–ø–∞–Ω–∏–∏ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∏–∑–∫–æ–π –∏–∑-–∑–∞ —Å–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ –±—é–¥–∂–µ—Ç–Ω—ã—Ö —Ç–æ–≤–∞—Ä–∞—Ö. –ù–æ—è–±—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–∏–∫ –≤—ã—Ä—É—á–∫–∏, –Ω–æ –ø–æ—Å–ª–µ–¥—É—é—â–µ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø—Ä–æ–¥–∞–∂ –±–æ–ª–µ–µ –¥–æ—Ä–æ–≥–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤.
# 
# 3. –•–∞—Ä–∞–∫—Ç–µ—Ä –∑–∞–∫–∞–∑–∞: –ß–∞—â–µ –≤—Å–µ–≥–æ –∑–∞–∫–∞–∑—ã –∏–º–µ—é—Ç –Ω–µ–±–æ–ª—å—à—É—é —Å—É–º–º—É –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ (–¥–æ 5 –µ–¥–∏–Ω–∏—Ü). –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é –Ω–∞ –º–∞—Å—Å–æ–≤—ã–π —Ä—ã–Ω–æ–∫.
# 
# 4. –ü–∏–∫–æ–≤—ã–µ —á–∞—Å—ã –∏ –¥–Ω–∏ –¥–ª—è –∑–∞–∫–∞–∑–æ–≤: –û—Å–Ω–æ–≤–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–∫—É–ø–æ–∫ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –≤ –±—É–¥–Ω–∏–µ –¥–Ω–∏ —Å 9 –¥–æ 16 —á–∞—Å–æ–≤, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã –∫–æ–º–ø–∞–Ω–∏–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è.

# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞ 2</b>
#     
#   –û —Å–µ–≥–º–µ–Ω—Ç–∞—Ö –ø–æ–¥—Ä–æ–±–Ω–µ–µ
# </div>
# 
# #### –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
# 
# 
# **–ö–ª–∞—Å—Ç–µ—Ä 1: –°–µ–≥–º–µ–Ω—Ç –∫—Ä—É–ø–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫**
# 
# - –û–±—â–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞:
#     - –ö–ª–∞—Å—Ç–µ—Ä 1 –≤–∫–ª—é—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏, —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ –±–æ–ª–µ–µ –¥–æ—Ä–æ–≥–∏–µ —Ç–æ–≤–∞—Ä—ã.
#     - –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –Ω–∏–∑–∫–∏–µ –æ–±—ä–µ–º—ã –ø—Ä–æ–¥–∞–∂, –∫–ª–∏–µ–Ω—Ç—ã –¥–µ–ª–∞—é—Ç –∫—Ä—É–ø–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∏ –∏ –º–µ–±–µ–ª–∏.
#     - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 3144 —Ä—É–±–ª–µ–π
#     - –ö–ª–∏–µ–Ω—Ç—ã —ç—Ç–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ —Å–æ–≤–µ—Ä—à–∞—é—Ç –ø–æ–∫—É–ø–∫–∏ —Å—Ä–∞–∑—É –∫—Ä—É–ø–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –µ–¥–∏–Ω–∏—Ü ‚Äî –≤ —Å—Ä–µ–¥–Ω–µ–º 10 –µ–¥–∏–Ω–∏—Ü –≤ –∑–∞–∫–∞–∑–µ
#     - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 4644 —Ä—É–±–ª–µ–π, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ –∫ –±–æ–ª–µ–µ –¥–æ—Ä–æ–≥–∏–º —Ç–æ–≤–∞—Ä–∞–º.
#     - –í —ç—Ç–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ –±—ã–ª–æ —Å–æ–≤–µ—Ä—à–µ–Ω–æ 268 –∑–∞–∫–∞–∑–æ–≤, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –º–µ–Ω—å—à–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ö–ª–∞—Å—Ç–µ—Ä–æ–º 2, –Ω–æ —Å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–º —Å—Ä–µ–¥–Ω–∏–º —á–µ–∫–æ–º
# 
# - –¢—Ä–µ–Ω–¥—ã –∏ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å:
#     - –°—Ç–∞–±–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–µ—Å –∫ —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–µ –∏ –º–µ–±–µ–ª–∏, —Å –≤–æ–ª–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º–∏ –∫–æ–ª–µ–±–∞–Ω–∏—è–º–∏ –≤ –ø—Ä–æ–¥–∞–∂–∞—Ö.
#     -  –ù–∏–∑–∫–∏–π –∏–Ω—Ç–µ—Ä–µ—Å –∫ —Ä–∞—Å—Å–∞–¥–∞–º –∏ –º–µ–Ω–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–µ—Å –∫ –ø–æ—Å—É–¥–µ, —Å –≤—Å–ø–ª–µ—Å–∫–æ–º –ø—Ä–æ–¥–∞–∂ –≤ —Å–µ–Ω—Ç—è–±—Ä–µ 2019 –≥–æ–¥–∞.
#     -  –°–µ–∑–æ–Ω–Ω—ã–π —Å–ø—Ä–æ—Å –Ω–∞ –¥–µ–∫–æ—Ä, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –ø—Ä–∞–∑–¥–Ω–∏–∫–∞–º–∏, –Ω–æ –≤ –¥–µ–∫–∞–±—Ä–µ 2019 –≥–æ–¥–∞ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Ä–µ–∑–∫–æ–µ –ø–∞–¥–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∂.
#     
# - –ö–∞—Ç–µ–≥–æ—Ä–∏–∏. –†–∞–∑–±–æ—Ä –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π:
# 
#     - –î–µ–∫–æ—Ä
#         - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: 2206
#         - –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞: 22
#         - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: 6695
#         - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: 37
# 
#     - –ü–æ—Å—É–¥–∞
#       - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: 1048
#       - –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞: 13
#       - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: 1779
#       - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: 11
# 
#     - –†–∞—Å—Å–∞–¥–∞, —Ä–∞—Å—Ç–µ–Ω–∏—è, —Ü–≤–µ—Ç—ã
#         - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: 476
#         - –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞: 4
#         - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: 1779
#         - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: 14
# 
#     - –°–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞, –º–µ–±–µ–ª—å –∏ –ø—Ä–æ—á–∏–µ –ö–ì–¢
#         - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: 4060
#         - –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞: 3
#         - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: 4666
#         - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: 142
# 
#     - –•–æ–∑—Ç–æ–≤–∞—Ä—ã
#        - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: 2585
#        - –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞: 18
#        - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: 4530
#        - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: 65 
#        
#        
# **–ö–ª–∞—Å—Ç–µ—Ä 2: –ú–∞—Å—Å–æ–≤—ã–π —Å–µ–≥–º–µ–Ω—Ç - –¶–µ–ª–µ–≤–æ–π**
# 
# - –û–±—â–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞:
# 
#   - –ö–ª–∞—Å—Ç–µ—Ä 2 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–∞–∏–±–æ–ª–µ–µ –º–∞—Å—Å–æ–≤—ã–π —Å–µ–≥–º–µ–Ω—Ç —Å –≤—ã—Å–æ–∫–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–∫–∞–∑–æ–≤ –∏ –æ–±—ä–µ–º–æ–º –ø—Ä–æ–¥–∞–∂.
#   - –ö–ª–∏–µ–Ω—Ç—ã –¥–∞–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö "–†–∞—Å—Å–∞–¥–∞, —Ä–∞—Å—Ç–µ–Ω–∏—è, —Ü–≤–µ—Ç—ã" –∏ "–•–æ–∑—Ç–æ–≤–∞—Ä—ã". –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 397 —Ä—É–±–ª–µ–π.
#    - –ö–ª–∏–µ–Ω—Ç—ã –¥–∞–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ —Å–æ–≤–µ—Ä—à–∞—é—Ç –ø–æ–∫—É–ø–∫–∏ –≤ —Å—Ä–µ–¥–Ω–µ–º 1-2—Ö —Ç–æ–≤–∞—Ä–æ–≤, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –∑–∞–∫–∞–∑—ã.
#    - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 506 —Ä—É–±–ª–µ–π, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é –Ω–∞ –±–æ–ª–µ–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã.
#    - –ó–∞ –∏—Å—Å–ª–µ–¥—É–µ–º—ã–π –ø–µ—Ä–∏–æ–¥ —Å–æ–≤–µ—Ä—à–µ–Ω–æ 3252 –∑–∞–∫–∞–∑–∞
# 
# - –¢—Ä–µ–Ω–¥—ã –∏ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å:
# 
#   - –í –≤–µ—Å–µ–Ω–Ω–∏–π –ø–µ—Ä–∏–æ–¥ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Ä–æ—Å—Ç –ø—Ä–æ–¥–∞–∂ —Å–µ–º—è–Ω –∏ —Ä–∞—Å—Ç–µ–Ω–∏–π, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ—Å–µ–≤–∞.
#   - –õ–µ—Ç–Ω–∏–µ –º–µ—Å—è—Ü—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç —Å–ø–∞–¥ –≤ –ø—Ä–æ–¥–∞–∂–∞—Ö –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —á—Ç–æ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ —Å–µ–∑–æ–Ω–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä —Å–ø—Ä–æ—Å–∞.
#   - –ü—Ä–æ–¥–∞–∂–∏ —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∏ –∏ –º–µ–±–µ–ª–∏ –Ω–∞—á–∏–Ω–∞—é—Ç —Ä–∞—Å—Ç–∏ –ª–µ—Ç–æ–º, –Ω–æ –Ω–µ –¥–æ—Å—Ç–∏–≥–∞—é—Ç –ø—Ä–µ–∂–Ω–∏—Ö —É—Ä–æ–≤–Ω–µ–π.
#   - –ü–∞–¥–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∂ –≤ –∏—é–Ω–µ 2019 –≥–æ–¥–∞ –∑–∞—Ç—Ä–æ–Ω—É–ª–æ –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —á—Ç–æ –º–æ–∂–µ—Ç —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ–≤–∞—Ç—å –æ –≤–Ω–µ—à–Ω–∏—Ö —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–∞—Ö.
#   
# - –ö–∞—Ç–µ–≥–æ—Ä–∏–∏. –†–∞–∑–±–æ—Ä –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π:
#     
#     - –î–µ–∫–æ—Ä
#         - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: 419
#         - –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞: 3
#         - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: 610
#         - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: 552
# 
#     - –ü–æ—Å—É–¥–∞
#       - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: 387
#       - –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞: 2
#       - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: 641
#       - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: 308
# 
#     - –†–∞—Å—Å–∞–¥–∞, —Ä–∞—Å—Ç–µ–Ω–∏—è, —Ü–≤–µ—Ç—ã
#         - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: 144
#         - –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞: 1
#         - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: 189
#         - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: 1011
# 
#     - –°–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞, –º–µ–±–µ–ª—å –∏ –ø—Ä–æ—á–∏–µ –ö–ì–¢
#         - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: 979
#         - –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞: 1
#         - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: 1045
#         - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: 819
# 
#     - –•–æ–∑—Ç–æ–≤–∞—Ä—ã
#         - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: 604
#         - –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞: 3
#         - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: 855
#         - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: 654
# 
# **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**
# 
# 
# 1. –£–ø–æ—Ä –Ω–∞ –º–∞—Å—Å–æ–≤—ã–π —Å–µ–≥–º–µ–Ω—Ç:
# 
#     - –ù–∞–∏–±–æ–ª—å—à–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —É —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π. –ü—Ä–∏–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ö–ì–¢, –Ω–æ –≤–≤–µ—Å—Ç–∏ –Ω–æ–≤—ã–µ –±—é–¥–∂–µ—Ç–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ —Ç–æ–≤–∞—Ä–∞ –≤ –º–∞—Ç—Ä–∏—Ü—É. –ü–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ —Ç–∞–∫–∏–µ, —á—Ç–æ –∫–ª–∏–µ–Ω—Ç—ã –Ω–µ –ø—Ä–∏–≤—ã–∫–ª–∏ —Ç—Ä–∞—Ç–∏—Ç—å –ø–æ–º–Ω–æ–≥—É - –º–æ–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å —Å –º–∞–ª–æ–≥–æ –∏ —Ä–∞–∑–≤–∏–≤–∞—Ç—å —Å–µ–≥–º–µ–Ω—Ç. –¢–∞–∫ –∫–∞–∫ –≤ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ –æ–Ω —É–≤–µ–ª–∏—á–∏—Ç –ø—Ä–∏–±—ã–ª—å –≤ —Ä–∞–∑—ã. –ü—Ä–∏–º–µ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:
#         - –°–æ–∑–¥–∞—Ç—å –ø–∞–∫–µ—Ç–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–º–ø–ª–µ–∫—Ç –∏–∑ —É–Ω–∏—Ç–∞–∑–∞, —Ä–∞–∫–æ–≤–∏–Ω—ã –∏ —Å–º–µ—Å–∏—Ç–µ–ª—è)
#         - –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —É—Å–ª—É–≥–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∏ –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ.
#         - –í–≤–µ—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É —Ä–∞—Å—Å—Ä–æ—á–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π –¥–ª—è –∫—Ä—É–ø–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫.
#         - –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤—ã—Å—Ç–∞–≤–æ—á–Ω—ã–µ –∑–æ–Ω—ã –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∫—Ä—É–ø–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤.
# 
#    -  –£–≤–µ–ª–∏—á–∏—Ç—å –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ —É—Å–∏–ª–∏—è –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–•–æ–∑—Ç–æ–≤–∞—Ä—ã" –∏ "–î–µ–∫–æ—Ä", —Ç–∞–∫ –∫–∞–∫ –≤ –∏—Ö —Ä–∞–º–∫–∞—Ö –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–π —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫, –∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –≥–æ–≤–æ—Ä–∏—Ç –æ–± –∏–Ω—Ç–µ—Ä–µ—Å–µ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:
#        - –°–æ–∑–¥–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–µ–∫–æ—Ä–∞ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤ (–ù–æ–≤—ã–π –≥–æ–¥, –ü–∞—Å—Ö–∞ –∏ —Ç.–¥.)
#        - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ (—Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ) –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –¥–µ–∫–æ—Ä–∞ –≤ –∏–Ω—Ç–µ—Ä—å–µ—Ä–µ.
#        - –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∫—Ä–æ—Å—Å-–ø—Ä–æ–¥–∞–∂ –º–µ–∂–¥—É –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–µ–∫–æ—Ä –∏ —Ö–æ–∑—Ç–æ–≤–∞—Ä—ã).
#        - –ü—Ä–æ–≤–æ–¥–∏—Ç—å –∞–∫—Ü–∏–∏ –Ω–∞ —Ö–æ–∑—Ç–æ–≤–∞—Ä—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ä–∞—Å—Å–∞–¥–æ–π –≤ –ø—Ä–µ–¥–¥–≤–µ—Ä–∏–∏ –¥–∞—á–Ω–æ–≥–æ —Å–µ–∑–æ–Ω–∞.
#        - –°–æ–∑–¥–∞—Ç—å —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–µ–∫–æ—Ä–∞ –¥–ª—è —Å–∞–¥–∞ –∏ –¥–∞—á–∏ —Å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–µ–π –≤ —Ç.—á. –ö–ì–¢ –º–µ–±–µ–ª–∏ –¥–ª—è —Å–∞–¥–∞
#        - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ –¥–ª—è –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è –∏–¥–µ–π –ø–æ —É–∫—Ä–∞—à–µ–Ω–∏—é —Å–∞–¥–æ–≤ –∏ –¥–≤–æ—Ä–æ–≤.
# 
# 2. –ö–ª–∞—Å—Ç–µ—Ä 1 –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å, –Ω–æ –≤—Ç–æ—Ä—ã–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º:
# 
#    - –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è —É–¥–µ—Ä–∂–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤. –ü–æ—Å–∫–æ–ª—å–∫—É –æ—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è - –ö–ì–¢, —Ç–æ –º–æ–∂–Ω–æ: 
#         - –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–µ–∫–ª–∞–º–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∏ —Å—Ç–∏–ª—å –º–µ–±–µ–ª–∏.
#         - –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —É—Å–ª—É–≥–∏ –ø–æ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–º—É –¥–∏–∑–∞–π–Ω—É –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ–¥–∞–≤–∞–µ–º–æ–π –º–µ–±–µ–ª–∏.
#         - –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç (–≤–∏–¥–µ–æ, —Å—Ç–∞—Ç—å–∏) –ø–æ –¥–∏–∑–∞–π–Ω—É –∏ –æ–±—É—Å—Ç—Ä–æ–π—Å—Ç–≤—É
#    - –£–≤–µ–ª–∏—á–∏—Ç—å –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–µ–º–∏—É–º-–∫–ª–∞—Å—Å–∞ –∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏–ª–∏ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã –¥–ª—è –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤. –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —É–ø–æ—Ä –Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤ —Å—Ç–æ—Ä–æ–Ω—É —Ö–æ–∑—Ç–æ–≤–∞—Ä–æ–≤ - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü –≤ —Å—Ä–µ–¥–Ω–µ–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—ã—Å–æ–∫–æ–µ, –∫–∞–∫ –∏ –ø—Ä–∞–π—Å —Ç–æ–≤–∞—Ä–∞:
#        - –ö—Ä–æ—Å—Å-–ø—Ä–æ–¥–∞–∂–∏ - –≤–º–µ—Å—Ç–µ —Å —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–æ–π –∏ –º–µ–±–µ–ª—å—é –ø–æ –∞–∫—Ü–∏–∏ –Ω–∞–±–æ—Ä —Ö–æ–∑—Ç–æ–≤–∞—Ä–æ–≤ (–ø–µ—Ä—á–∞—Ç–∫–∏, —Ä–∞—Å—Ö–æ–¥–Ω–∏–∫–∏ –∏ —Ç.–¥.)
#        - –í–Ω–µ–¥—Ä–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
#        - –í–Ω–µ–¥—Ä–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–æ–∫—É–ø–æ–∫ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞
#    
#    
# **–ò—Ç–æ–≥–æ**, –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤–∏–¥–Ω–æ, —á—Ç–æ –ö–ª–∞—Å—Ç–µ—Ä 2 (–º–∞—Å—Å–æ–≤—ã–π —Å–µ–≥–º–µ–Ω—Ç) —è–≤–ª—è–µ—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ –∞–∫—Ç–∏–≤–Ω—ã–º –∏ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω—ã–º —Å –≤—ã—Å–æ–∫–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–∫–∞–∑–æ–≤ –∏ —á–∞—Å—Ç–æ—Ç–æ–π –ø–æ–∫—É–ø–æ–∫. –ö–ª–∞—Å—Ç–µ—Ä 1 (–ø—Ä–µ–º–∏—É–º-—Å–µ–≥–º–µ–Ω—Ç) –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫–∏–π —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–º –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏.
# 
# –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –ø—Ä–æ–¥–∞–∂ –≤ **–º–∞—Å—Å–æ–≤–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ** —á–µ—Ä–µ–∑ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏, –∞ —Ç–∞–∫–∂–µ –∏–∑—É—á–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø—Ä–µ–º–∏—É–º-—Å–µ–≥–º–µ–Ω—Ç–∞. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø—Ä–æ–¥–∞–∂ –∏ —É–≤–µ–ª–∏—á–∏—Ç—å –æ–±—â—É—é –ø—Ä–∏–±—ã–ª—å –∫–æ–º–ø–∞–Ω–∏–∏. –ö–ª–∞—Å—Ç–µ—Ä 2 —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è –∫ —Å–µ–∑–æ–Ω–Ω—ã–º –∫–æ–ª–µ–±–∞–Ω–∏—è–º —Å–ø—Ä–æ—Å–∞ –∏ –ø–æ–≤—ã—à–µ–Ω–∏—é –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤, —Ç–æ–≥–¥–∞ –∫–∞–∫ –∫–ª–∞—Å—Ç–µ—Ä 1 –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –∞–∫—Ü–µ–Ω—Ç–µ –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞ –∫ –∫–ª—é—á–µ–≤—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Ç–æ–≤–∞—Ä–æ–≤. 
# 
# –î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–¥–∞–∂ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å—Ç–æ–∏—Ç –≤–Ω–µ–¥—Ä–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–æ–∫—É–ø–∫–∞—Ö. –ü—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏ –∏ —Å–∫–∏–¥–∫–∞–º–∏ –º–æ–≥—É—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—Å–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å —É–¥–µ—Ä–∂–∞–Ω–∏—è.
# 
# –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∞–∫—Ü–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–µ–∑–æ–Ω–∞ –∏ –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤ –±—É–¥—É—Ç —Å–ø–æ—Å–æ–±—Å—Ç–≤–æ–≤–∞—Ç—å —Å—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏—é –ø–æ–∫—É–ø–æ–∫. –ù–∞–∫–æ–Ω–µ—Ü, –≤–∞–∂–Ω–æ —Å–æ–±–∏—Ä–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ —Ç–æ–≤–∞—Ä–∞—Ö –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è.

# <div class="alert alert-danger">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞</b>
# 
#   ‚ùå –ó–∞–∫–∞–∑—á–∏–∫—É –Ω—É–∂–Ω—ã –ø–æ–¥—Ä–æ–±–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º. –£ –∫–∞–∫–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞, –Ω–∞ –∫–∞–∫—É—é —Å—Ä–µ–¥–Ω—é—é —Å—É–º–º—É, –∫–∞–∫ —á–∞—Å—Ç–æ –∏ —Å –∫–∞–∫–∏–º —Å—Ä–µ–¥–Ω–∏–º –ø—Ä–∞–π—Å–æ–º –ø–æ–∫—É–ø–∞—é—Ç. –ö–∞–∫–∏–º –∫–ª–∏–µ–Ω—Ç–∞–º –∫–æ–≥–¥–∞ –∏ –∫–∞–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–∞ —Ä–∞—Å—Å—ã–ª–∞—Ç—å –≤ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö. –ö–∞–∫ –∏ –¥–ª—è –∫–∞–∫–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –º–æ–∂–Ω–æ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ç–æ–≤–∞—Ä–∞, –ø–æ–≤—ã—Å–∏—Ç—å –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ—Å—Ç—å –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏ —Ç.–¥. –≠—Ç–æ –∂–µ –±—ã–ª–∞ –Ω–∞—à–∞ –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å.
# </div>

# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞</b>
#     
# 1. –û–ø–∏—Å–∞–Ω–∏–µ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º —Ä–∞—Å—à–∏—Ä–µ–Ω–æ: –µ—Å—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–π –ø–æ –≤–µ–¥—É—â–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –∫ –Ω–∏–º —á–µ—Ç–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ 
#     
# 2. –î–æ–±–∞–≤–ª–µ–Ω—ã —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
# </div>
# <div class="alert alert-danger">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ v.2</b>
# 
#   ‚ùå –°—Ç–æ–∏—Ç —Ä–∞—Å—à–∏—Ä–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–æ–≤: –∫–∞–∫ —á–∞—Å—Ç–æ —Å–æ–≤–µ—Ä—à–∞—é—Ç –ø–æ–∫—É–ø–∫–∏, —Å –∫–∞–∫–æ–π —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω–æ–π —Ç–æ–≤–∞—Ä—ã –∏ —Ç.–¥. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ –æ–ø–∏—Å—ã–≤–∞—é—Ç —Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –ø—Ä–æ–≤–æ–¥–∏–ª–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é. –°–µ–π—á–∞—Å –∑—â–∞–∫–∞–∑—á–∏–∫—É —Å–ª–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –Ω–∞ –∫–∞–æ–π —Å–µ–≥–º–µ–Ω—Ç —Å—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ, –∞ –∫–∞–∫–æ–π –º–∞–ª–æ–ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω—ã–π.
# </div>

# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞ 2</b>
#     
#   –î–æ–ø–æ–ª–Ω–∏–ª–∏ –≤—ã–≤–æ–¥—ã. –ú–µ—Ç–∫–∞ –≤—ã—à–µ
# </div>
#  <div class="alert alert-warning">
#     
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ v.3</b>
#     
#   ‚ö†Ô∏è –í—ã–≤–æ–¥—ã —Ç–∞–∫-–∂–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å.
#     
# </div>

# <div class="alert alert-block alert-info">
#   
#   <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π c—Ç—É–¥–µ–Ω—Ç–∞ –û—Ñ—Ñ—Ç–æ–ø</b>
#     
#   –û—Ç–ø—Ä–∞–≤—å , –ø–æ–¥–∞–ª—É–π—Å—Ç–∞, –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É –∫–æ–¥ –¥–∞–∂–µ –µ—Å–ª–∏ –≤—Å–µ –æ–∫–µ–π. –ü–æ–∫–∞ –Ω–µ –ø—Ä–∞–≤–ª—é –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –±—É–¥—É—Ç –µ—â–µ –∑–∞–º–µ—á–∞–Ω–∏—è
# </div>

# ### –°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é
# 
# https://disk.yandex.ru/i/A1PuqJQMXojxzw

# <div style="border:solid black 2px; padding: 20px">
#      
#   <b>–ß–µ–∫-–ª–∏—Å—Ç –¥–æ—Ä–∞–±–æ—Ç–æ–∫</b>
#     
#   
#   üìÉ –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±—Ä–µ–∑–∫—É –≤—ã–±—Ä–æ—Å–æ–≤ –ø–æ –ø—Ä–∞–π—Å—É.
# 
#   üìÉ –î–æ–±–∞–≤–∏—Ç—å –≤ –∞–Ω–∞–ª–∏–∑ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
#     
#   üìÉ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.
#     
#   üìÉ –ü–æ –∫–∞–∂–¥–æ–º—É —Å–µ–≥–º–µ–Ω—Ç—É –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–∞ –∏ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å.
#     
#   üìÉ –û–±–æ—Å–Ω–æ–≤–∞—Ç—å –≤—ã–±–æ—Ä —Å—Ç–∞—Ç. —Ç–µ—Å—Ç–∞.
#     
#   üìÉ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å —Å—Ç–∞—Ç. –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –≥–∏–ø–æ—Ç–µ–∑.
#     
#   üìÉ –í –æ–±—â–µ–º –≤—ã–≤–æ–¥–µ, –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –æ—Ç–¥–µ–ª—å–Ω–æ.
#     
#     
# –ñ–¥—É —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ä–µ–≤—å—é. –ù–µ —Å—Ç–µ—Å–Ω—è–π—Å—è –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã. –£–¥–∞—á–∏! –í—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è.
# </div>

# <div style="border:solid black 2px; padding: 20px">
#      
#   <b>–ß–µ–∫-–ª–∏—Å—Ç –¥–æ—Ä–∞–±–æ—Ç–æ–∫ v.2</b>
#     
#   
#   üìÉ –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±—Ä–µ–∑–∫—É –≤—ã–±—Ä–æ—Å–æ–≤, —Ç–µ—Ä—è–µ–º –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö.
# 
#   üìÉ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.
#     
#   üìÉ –í –æ–±—â–µ–º –≤—ã–≤–æ–¥–µ, –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –æ—Ç–¥–µ–ª—å–Ω–æ.
#     
#     
# </div>

# <div style="border:solid black 2px; padding: 20px">
#      
#   <b>–ß–µ–∫-–ª–∏—Å—Ç –¥–æ—Ä–∞–±–æ—Ç–æ–∫ v.3</b>
#     
#   
#   üìÉ –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±—Ä–µ–∑–∫—É –≤—ã–±—Ä–æ—Å–æ–≤, —Ç–µ—Ä—è–µ–º –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö.
# 
# 
# </div>

# <div style="border:solid black 2px; padding: 20px">
#      
#   <b>–ß–µ–∫-–ª–∏—Å—Ç –¥–æ—Ä–∞–±–æ—Ç–æ–∫ v.4</b>
#     
#   
#   üìÉ –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±—Ä–µ–∑–∫—É –≤—ã–±—Ä–æ—Å–æ–≤, —Ç–µ—Ä—è–µ–º –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö.
# 
# 
# </div>
